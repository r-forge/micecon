
R version 2.4.1 (2006-12-18)
Copyright (C) 2006 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(micEcon)
Loading required package: systemfit
> library(mvtnorm)
> N <- 1500
> vc <- diag(3)
> vc[lower.tri(vc)] <- c(0.9, 0.5, 0.6)
> vc[upper.tri(vc)] <- vc[lower.tri(vc)]
> set.seed(1)
> ## Tobit-5 example
> eps <- rmvnorm(N, rep(0, 3), vc)
> xs <- runif(N)
> ys <- xs + eps[,1] > 0
> xo1 <- runif(N)
> yo1 <- xo1 + eps[,2]
> xo2 <- runif(N)
> yo2 <- xo2 + eps[,3]
> a <- selection(ys~xs, list(yo1 ~ xo1, yo2 ~ xo2))
  > print(summary(a))
--------------------------------------------
Maximum Likelihood estimation
Newton-Raphson maximisation, 9 iterations
Return code 2: successive function values within tolerance limit.
 May be a solution
Log-Likelihood: -2811.213 
10  free parameters
Estimates:
               Estimate Std. error t value   Pr(> t)    
(Intercept)   0.0048633  0.0567390  0.0857  0.931694    
xs            0.9576546  0.0935031 10.2420 < 2.2e-16 ***
X1(Intercept) 0.0625463  0.1166480  0.5362  0.591823    
X1xo1         0.9967841  0.1150525  8.6637 < 2.2e-16 ***
sigma1        1.1174569  0.0669138 16.6999 < 2.2e-16 ***
rho1          0.9025633  0.0264876 34.0749 < 2.2e-16 ***
X2(Intercept) 0.0738154  0.1112034  0.6638  0.506827    
X2xo2         0.9383803  0.1005747  9.3302 < 2.2e-16 ***
sigma2        0.9982388  0.0479546 20.8163 < 2.2e-16 ***
rho2          0.4770454  0.1584005  3.0116  0.002598 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 
--------------------------------------------
> ## Toit-2 exmple
> vc <- diag(2)
> vc[2,1] <- vc[1,2] <- -0.7
> eps <- rmvnorm(N, rep(0, 2), vc)
> xs <- runif(N)
> ys <- xs + eps[,1] > 0
> xo <- runif(N)
> yo <- (xo + eps[,2])*(ys > 0)
> a <- selection(ys~xs, yo ~xo)
  > print(summary(a))
--------------------------------------------
Tobit 2 selection model/Maximum Likelihood estimation
Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero. May be a solution
Log-Likelihood: -2170.018 
1500 observations (463 censored and 1037 observed) and 6 free parameters (df =1494)

Probit selection equation:
               Estimate Std. error    t value      Pr(> t)
(Intercept) -0.04246831 0.06148921 -0.6906628 4.897775e-01
xs           1.13560804 0.11255852 10.0890459 6.176692e-24

OLS equation:
              Estimate Std. error    t value      Pr(> t)
(Intercept) 0.03748543 0.06131208  0.6113873 5.409432e-01
xo          0.95868620 0.08813289 10.8777344 1.471754e-27

Error terms data:
        Estimate Std. error   t value       Pr(> t)
sigma  0.9949523 0.03632214  27.39244 3.374263e-165
rho   -0.7623214 0.05147802 -14.80868  1.287489e-49
--------------------------------------------
> 
> 
