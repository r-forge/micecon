
R version 2.4.1 (2006-12-18)
Copyright (C) 2006 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(micEcon)
Loading required package: systemfit
> library(mvtnorm)
> N <- 1500
> NNA <- 5
> vc <- diag(3)
> vc[lower.tri(vc)] <- c(0.9, 0.5, 0.6)
> vc[upper.tri(vc)] <- vc[lower.tri(vc)]
> set.seed(1)
> ## ------- Tobit-5 example ---------
> eps <- rmvnorm(N, rep(0, 3), vc)
> xs <- runif(N)
> ys <- xs + eps[,1] > 0
> xo1 <- runif(N)
> yo1 <- xo1 + eps[,2]
> xo2 <- runif(N)
> yo2 <- xo2 + eps[,3]
> ## Put some NA-s into the data
> ys[sample(N, NNA)] <- NA
> xs[sample(N, NNA)] <- NA
> xo1[sample(N, NNA)] <- NA
> xo2[sample(N, NNA)] <- NA
> yo1[sample(N, NNA)] <- NA
> yo2[sample(N, NNA)] <- NA
> a <- selection(ys~xs, list(yo1 ~ xo1, yo2 ~ xo2))
  > print(summary(a))
--------------------------------------------
Maximum Likelihood estimation
Newton-Raphson maximisation, 9 iterations
Return code 2: successive function values within tolerance limit.
 May be a solution
Log-Likelihood: -2774.843 
10  free parameters
Estimates:
                Estimate Std. error t value   Pr(> t)    
(Intercept)    0.0020985  0.0570640  0.0368  0.970665    
xs             0.9558618  0.0939042 10.1791 < 2.2e-16 ***
XO1(Intercept) 0.0712029  0.1166143  0.6106  0.541475    
XO1xo1         0.9869915  0.1158941  8.5163 < 2.2e-16 ***
sigma1         1.1213988  0.0672176 16.6831 < 2.2e-16 ***
rho1           0.9034608  0.0263014 34.3503 < 2.2e-16 ***
XO2(Intercept) 0.0708691  0.1116397  0.6348  0.525558    
XO2xo2         0.9361839  0.1016234  9.2123 < 2.2e-16 ***
sigma2         0.9979964  0.0479670 20.8059 < 2.2e-16 ***
rho2           0.4721812  0.1598734  2.9535  0.003142 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 
--------------------------------------------
> ## ------- Tobit-2 exmple -----------
> vc <- diag(2)
> vc[2,1] <- vc[1,2] <- -0.7
> eps <- rmvnorm(N, rep(0, 2), vc)
> xs <- runif(N)
> ys <- xs + eps[,1] > 0
> xo <- runif(N)
> yo <- (xo + eps[,2])*(ys > 0)
> xs[sample(N, NNA)] <- NA
> ys[sample(N, NNA)] <- NA
> xo[sample(N, NNA)] <- NA
> yo[sample(N, NNA)] <- NA
> a <- selection(ys~xs, yo ~xo)
  > print(summary(a))
--------------------------------------------
Tobit 2 selection model/Maximum Likelihood estimation
Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero. May be a solution
Log-Likelihood: -2159.85 
1481 observations (461 censored and 1020 observed) and 6 free parameters (df =1475)

Probit selection equation:
              Estimate Std. error   t value      Pr(> t)
(Intercept) 0.04198554 0.06039229 0.6952136 4.869215e-01
xs          0.93125476 0.10844639 8.5872365 8.908615e-18

OLS equation:
             Estimate Std. error   t value      Pr(> t)
(Intercept) 0.0697286 0.06165793  1.130894 2.580996e-01
xo          0.9502578 0.08967288 10.596936 3.079031e-26

Error terms data:
        Estimate Std. error   t value       Pr(> t)
sigma  1.0125371 0.03672398  27.57155 2.441746e-167
rho   -0.7790971 0.04532607 -17.18872  3.225677e-66
--------------------------------------------
> 
> 
