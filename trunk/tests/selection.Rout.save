
R version 2.4.0 (2006-10-03)
Copyright (C) 2006 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(micEcon)
Loading required package: systemfit
> library(mvtnorm)
> N <- 1500
> NNA <- 5
> vc <- diag(3)
> vc[lower.tri(vc)] <- c(0.9, 0.5, 0.6)
> vc[upper.tri(vc)] <- vc[lower.tri(vc)]
> set.seed(1)
> ## ------- Tobit-5 example ---------
> eps <- rmvnorm(N, rep(0, 3), vc)
> xs <- runif(N)
> ys <- xs + eps[,1] > 0
> xo1 <- runif(N)
> yo1 <- xo1 + eps[,2]
> xo2 <- runif(N)
> yo2 <- xo2 + eps[,3]
> ## Put some NA-s into the data
> ys[sample(N, NNA)] <- NA
> xs[sample(N, NNA)] <- NA
> xo1[sample(N, NNA)] <- NA
> xo2[sample(N, NNA)] <- NA
> yo1[sample(N, NNA)] <- NA
> yo2[sample(N, NNA)] <- NA
> a <- selection(ys~xs, list(yo1 ~ xo1, yo2 ~ xo2))
  > print(summary(a))
--------------------------------------------
Tobit 5 selection model/Maximum Likelihood estimation
Newton-Raphson maximisation, 9 iterations
Return code 2: successive function values within tolerance limit.
 May be a solution
Log-Likelihood: -2774.843 
1479 observations (479 selection 1 and 1000 selection 2) and 10 free parameters (df = 1469)

Probit selection equation:
             Estimate Std. error t value Pr(> t)    
(Intercept) 0.0020985  0.0570640  0.0368  0.9707    
xs          0.9558618  0.0939042 10.1791  <2e-16 ***

outcome equation 1:
               Estimate Std. error t value Pr(> t)    
XO1(Intercept) 0.071203   0.116614  0.6106  0.5415    
XO1xo1         0.986992   0.115894  8.5163  <2e-16 ***

outcome equation 2:
               Estimate Std. error t value Pr(> t)    
XO2(Intercept) 0.070869   0.111640  0.6348  0.5256    
XO2xo2         0.936184   0.101623  9.2123  <2e-16 ***

Error terms data:
       Estimate Std. error t value   Pr(> t)    
sigma1 1.121399   0.067218 16.6831 < 2.2e-16 ***
sigma2 0.997996   0.047967 20.8059 < 2.2e-16 ***
rho1   0.903461   0.026301 34.3503 < 2.2e-16 ***
rho2   0.472181   0.159873  2.9535  0.003142 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
--------------------------------------------
> ## ------- Tobit-2 exmple -----------
> vc <- diag(2)
> vc[2,1] <- vc[1,2] <- -0.7
> eps <- rmvnorm(N, rep(0, 2), vc)
> xs <- runif(N)
> ys <- xs + eps[,1] > 0
> xo <- runif(N)
> yo <- (xo + eps[,2])*(ys > 0)
> xs[sample(N, NNA)] <- NA
> ys[sample(N, NNA)] <- NA
> xo[sample(N, NNA)] <- NA
> yo[sample(N, NNA)] <- NA
> a <- selection(ys~xs, yo ~xo)
  > print(summary(a))
--------------------------------------------
Tobit 2 selection model/Maximum Likelihood estimation
Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero. May be a solution
Log-Likelihood: -2159.85 
1481 observations (461 censored and 1020 observed) and 6 free parameters (df = 1475)

Probit selection equation:
            Estimate Std. error t value Pr(> t)    
(Intercept) 0.041986   0.060392  0.6952  0.4869    
xs          0.931255   0.108446  8.5872  <2e-16 ***

OLS equation:
            Estimate Std. error t value Pr(> t)    
(Intercept) 0.069729   0.061658  1.1309  0.2581    
xo          0.950258   0.089673 10.5969  <2e-16 ***

Error terms data:
       Estimate Std. error t value   Pr(> t)    
sigma  1.012537   0.036724  27.572 < 2.2e-16 ***
rho   -0.779097   0.045326 -17.189 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
--------------------------------------------
> 
> 
