
R version 2.5.0 (2007-04-23)
Copyright (C) 2007 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library( micEcon )
Loading required package: systemfit
> data( Blanciforti86 )
> options( digits = 3 )
> 
> set <- !is.na( Blanciforti86$pFood1 )
> setWo1 <- set & rownames( Blanciforti86 ) != 1947
> pNames <- c( "pFood1", "pFood2", "pFood3", "pFood4" )
> wNames <- c( "wFood1", "wFood2", "wFood3", "wFood4" )
> wMeans <- colMeans( Blanciforti86[ set, wNames ] )
> pMeans <- colMeans( Blanciforti86[ set, pNames ] )
> 
> cat( paste( "\nRepeating the demand analysis of Blanciforti, Green",
+    "& King (1986)\n" ) )

Repeating the demand analysis of Blanciforti, Green & King (1986)
> estResultLA <- aidsEst( pNames, wNames, "xFood",
+    data = Blanciforti86[ set, ], method = "LA:SL" )
> print( estResultLA )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.255  0.110  0.261  0.884 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3287  0.0559 -0.0747 -0.3099 
gamma
        pFood1   pFood2    pFood3    pFood4
wFood1  0.1107 -0.13851 -0.011881  0.039732
wFood2 -0.1385  0.15820 -0.003476 -0.016216
wFood3 -0.0119 -0.00348  0.014589  0.000768
wFood4  0.0397 -0.01622  0.000768 -0.024285
> print( summary( estResultLA, elaFormula = "Ch", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.255  0.110  0.261  0.884 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3287  0.0559 -0.0747 -0.3099 
gamma
        pFood1   pFood2    pFood3    pFood4
wFood1  0.1107 -0.13851 -0.011881  0.039732
wFood2 -0.1385  0.15820 -0.003476 -0.016216
wFood3 -0.0119 -0.00348  0.014589  0.000768
wFood4  0.0397 -0.01622  0.000768 -0.024285

Demand Elasticities (Formula of Chalfant / Goddard)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.058  1.278  0.443  0.124 

Marshallian (uncompensated) Price Elasticities
        pFood1  pFood2  pFood3 pFood4
wFood1 -0.9726 -0.6586 -0.1801 -0.246
wFood2 -0.7746 -0.2699 -0.0546 -0.179
wFood3  0.0846  0.0862 -0.8165  0.203
wFood4  0.3844  0.1304  0.1196 -0.759

Hicksian (compensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.333 -0.2444  0.0959  0.482
wFood2 -0.377 -0.0127  0.1169  0.273
wFood3  0.222  0.1753 -0.7571  0.360
wFood4  0.423  0.1554  0.1363 -0.715
> # imposing restrictions via TX
> estResultLATX <- aidsEst( pNames, wNames, "xFood",
+    data = Blanciforti86[ set, ], method = "LA:SL",
+    TX = TRUE )
> print( estResultLATX )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.255  0.110  0.261  0.884 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3287  0.0559 -0.0747 -0.3099 
gamma
        pFood1   pFood2    pFood3    pFood4
wFood1  0.1107 -0.13851 -0.011881  0.039732
wFood2 -0.1385  0.15820 -0.003476 -0.016216
wFood3 -0.0119 -0.00348  0.014589  0.000768
wFood4  0.0397 -0.01622  0.000768 -0.024285
> print( summary( estResultLATX, elaFormula = "Ch", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.255  0.110  0.261  0.884 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3287  0.0559 -0.0747 -0.3099 
gamma
        pFood1   pFood2    pFood3    pFood4
wFood1  0.1107 -0.13851 -0.011881  0.039732
wFood2 -0.1385  0.15820 -0.003476 -0.016216
wFood3 -0.0119 -0.00348  0.014589  0.000768
wFood4  0.0397 -0.01622  0.000768 -0.024285

Demand Elasticities (Formula of Chalfant / Goddard)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.058  1.278  0.443  0.124 

Marshallian (uncompensated) Price Elasticities
        pFood1  pFood2  pFood3 pFood4
wFood1 -0.9726 -0.6586 -0.1801 -0.246
wFood2 -0.7746 -0.2699 -0.0546 -0.179
wFood3  0.0846  0.0862 -0.8165  0.203
wFood4  0.3844  0.1304  0.1196 -0.759

Hicksian (compensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.333 -0.2444  0.0959  0.482
wFood2 -0.377 -0.0127  0.1169  0.273
wFood3  0.222  0.1753 -0.7571  0.360
wFood4  0.423  0.1554  0.1363 -0.715
> estResultLATX$call <- NULL
> estResultLATX$est$bt <- NULL
> estResultLATX$est$btcov <- NULL
> estResultLATX$est$x <- NULL
> estResultLATX$est$TX <- NULL
> estResultLATX$est$q.restr <- NULL
> estResultLA$call <- NULL
> estResultLA$est$x <- NULL
> estResultLA$est$R.restr <- NULL
> estResultLA$est$q.restr <- NULL
> print( all.equal( estResultLA, estResultLATX ) )
[1] TRUE
> 
> ## only homogeneity (no symmetry imposed)
> estResultLAhom <- aidsEst( pNames, wNames, "xFood", sym = FALSE,
+    data = Blanciforti86[ set, ], method = "LA:SL" )
> print( estResultLAhom )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.2600  0.0914  0.2441  0.9245 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3326  0.0656 -0.0653 -0.3329 
gamma
         pFood1  pFood2  pFood3    pFood4
wFood1  0.10972 -0.1210 -0.0458  0.056998
wFood2 -0.13009  0.1244  0.0312 -0.025525
wFood3 -0.00526 -0.0251  0.0312 -0.000772
wFood4  0.02563  0.0217 -0.0166 -0.030701
> print( summary( estResultLAhom, elaFormula = "Ch", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.2600  0.0914  0.2441  0.9245 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3326  0.0656 -0.0653 -0.3329 
gamma
         pFood1  pFood2  pFood3    pFood4
wFood1  0.10972 -0.1210 -0.0458  0.056998
wFood2 -0.13009  0.1244  0.0312 -0.025525
wFood3 -0.00526 -0.0251  0.0312 -0.000772
wFood4  0.02563  0.0217 -0.0166 -0.030701

Demand Elasticities (Formula of Chalfant / Goddard)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
2.0702 1.3262 0.5128 0.0593 

Marshallian (uncompensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.980 -0.6046 -0.2908 -0.195
wFood2 -0.748 -0.4474  0.1112 -0.242
wFood3  0.112 -0.0893 -0.7023  0.167
wFood4  0.365  0.2505  0.0793 -0.754

Hicksian (compensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.336 -0.1880 -0.0131  0.537
wFood2 -0.336 -0.1805  0.2891  0.227
wFood3  0.272  0.0139 -0.6336  0.348
wFood4  0.383  0.2625  0.0872 -0.733
> # imposing restrictions via TX
> estResultLAhomTX <- aidsEst( pNames, wNames, "xFood", sym = FALSE,
+    data = Blanciforti86[ set, ], method = "LA:SL",
+    TX = TRUE )
> print( estResultLAhomTX )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.2600  0.0914  0.2441  0.9245 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3326  0.0656 -0.0653 -0.3329 
gamma
         pFood1  pFood2  pFood3    pFood4
wFood1  0.10972 -0.1210 -0.0458  0.056998
wFood2 -0.13009  0.1244  0.0312 -0.025525
wFood3 -0.00526 -0.0251  0.0312 -0.000772
wFood4  0.02563  0.0217 -0.0166 -0.030701
> print( summary( estResultLAhomTX, elaFormula = "Ch", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.2600  0.0914  0.2441  0.9245 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3326  0.0656 -0.0653 -0.3329 
gamma
         pFood1  pFood2  pFood3    pFood4
wFood1  0.10972 -0.1210 -0.0458  0.056998
wFood2 -0.13009  0.1244  0.0312 -0.025525
wFood3 -0.00526 -0.0251  0.0312 -0.000772
wFood4  0.02563  0.0217 -0.0166 -0.030701

Demand Elasticities (Formula of Chalfant / Goddard)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
2.0702 1.3262 0.5128 0.0593 

Marshallian (uncompensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.980 -0.6046 -0.2908 -0.195
wFood2 -0.748 -0.4474  0.1112 -0.242
wFood3  0.112 -0.0893 -0.7023  0.167
wFood4  0.365  0.2505  0.0793 -0.754

Hicksian (compensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.336 -0.1880 -0.0131  0.537
wFood2 -0.336 -0.1805  0.2891  0.227
wFood3  0.272  0.0139 -0.6336  0.348
wFood4  0.383  0.2625  0.0872 -0.733
> estResultLAhomTX$call <- NULL
> estResultLAhomTX$est$bt <- NULL
> estResultLAhomTX$est$btcov <- NULL
> estResultLAhomTX$est$x <- NULL
> estResultLAhomTX$est$TX <- NULL
> estResultLAhomTX$est$q.restr <- NULL
> estResultLAhom$call <- NULL
> estResultLAhom$est$x <- NULL
> estResultLAhom$est$R.restr <- NULL
> estResultLAhom$est$q.restr <- NULL
> print( all.equal( estResultLAhom, estResultLAhomTX ) )
[1] TRUE
> 
> ## unrestricted (no homogeneity and no symmetry imposed)
> estResultLAunr <- aidsEst( pNames, wNames, "xFood", hom = FALSE, sym = FALSE,
+    data = Blanciforti86[ set, ], method = "LA:SL" )
> print( estResultLAunr )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.0755  0.1564  0.2428  0.6764 
beta
   wFood1    wFood2    wFood3    wFood4 
 0.147433  0.000476 -0.063987 -0.083922 
gamma
         pFood1  pFood2   pFood3   pFood4
wFood1  0.12013 -0.0454 -0.05451  0.01033
wFood2 -0.12643  0.1510  0.02811 -0.04195
wFood3 -0.00534 -0.0257  0.03122 -0.00043
wFood4  0.01163 -0.0799 -0.00482  0.03205
> print( summary( estResultLAunr, elaFormula = "Ch", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.0755  0.1564  0.2428  0.6764 
beta
   wFood1    wFood2    wFood3    wFood4 
 0.147433  0.000476 -0.063987 -0.083922 
gamma
         pFood1  pFood2   pFood3   pFood4
wFood1  0.12013 -0.0454 -0.05451  0.01033
wFood2 -0.12643  0.1510  0.02811 -0.04195
wFood3 -0.00534 -0.0257  0.03122 -0.00043
wFood4  0.01163 -0.0799 -0.00482  0.03205

Demand Elasticities (Formula of Chalfant / Goddard)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 1.474  1.002  0.523  0.763 

Marshallian (uncompensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.761 -0.2416 -0.2390 -0.135
wFood2 -0.629 -0.2501  0.1394 -0.209
wFood3  0.108 -0.0954 -0.7032  0.166
wFood4  0.107 -0.1781  0.0182 -0.826

Hicksian (compensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.303  0.0551 -0.0413  0.387
wFood2 -0.317 -0.0484  0.2738  0.145
wFood3  0.271  0.0098 -0.6331  0.351
wFood4  0.344 -0.0246  0.1205 -0.556
> # imposing restrictions via TX
> estResultLAunrTX <- aidsEst( pNames, wNames, "xFood", hom = FALSE, sym = FALSE,
+    data = Blanciforti86[ set, ], method = "LA:SL",
+    TX = TRUE )
> print( estResultLAunrTX )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.0755  0.1564  0.2428  0.6764 
beta
   wFood1    wFood2    wFood3    wFood4 
 0.147433  0.000476 -0.063987 -0.083922 
gamma
         pFood1  pFood2   pFood3   pFood4
wFood1  0.12013 -0.0454 -0.05451  0.01033
wFood2 -0.12643  0.1510  0.02811 -0.04195
wFood3 -0.00534 -0.0257  0.03122 -0.00043
wFood4  0.01163 -0.0799 -0.00482  0.03205
> print( summary( estResultLAunrTX, elaFormula = "Ch", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.0755  0.1564  0.2428  0.6764 
beta
   wFood1    wFood2    wFood3    wFood4 
 0.147433  0.000476 -0.063987 -0.083922 
gamma
         pFood1  pFood2   pFood3   pFood4
wFood1  0.12013 -0.0454 -0.05451  0.01033
wFood2 -0.12643  0.1510  0.02811 -0.04195
wFood3 -0.00534 -0.0257  0.03122 -0.00043
wFood4  0.01163 -0.0799 -0.00482  0.03205

Demand Elasticities (Formula of Chalfant / Goddard)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 1.474  1.002  0.523  0.763 

Marshallian (uncompensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.761 -0.2416 -0.2390 -0.135
wFood2 -0.629 -0.2501  0.1394 -0.209
wFood3  0.108 -0.0954 -0.7032  0.166
wFood4  0.107 -0.1781  0.0182 -0.826

Hicksian (compensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.303  0.0551 -0.0413  0.387
wFood2 -0.317 -0.0484  0.2738  0.145
wFood3  0.271  0.0098 -0.6331  0.351
wFood4  0.344 -0.0246  0.1205 -0.556
> estResultLAunrTX$call <- NULL
> estResultLAunrTX$est$bt <- NULL
> estResultLAunrTX$est$btcov <- NULL
> estResultLAunrTX$est$x <- NULL
> estResultLAunrTX$est$TX <- NULL
> estResultLAunrTX$est$q.restr <- NULL
> estResultLAunr$call <- NULL
> estResultLAunr$est$x <- NULL
> estResultLAunr$est$R.restr <- NULL
> estResultLAunr$est$q.restr <- NULL
> print( all.equal( estResultLAunr, estResultLAunrTX ) )
[1] TRUE
> 
> #####################################################
> cat( paste( "\nRepeating the evaluation of different elasticity formulas",
+    "of Green & Alston (1990): iterated AIDS\n" ) )

Repeating the evaluation of different elasticity formulas of Green & Alston (1990): iterated AIDS
> estResultAIDS <- aidsEst( pNames, wNames, "xFood",
+    data = Blanciforti86[ setWo1, ], ILmaxiter = 1,
+    ILtol=1e-7,
+    method = "IL:L" )
> print( estResultAIDS )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.240  0.120  0.267  0.854 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3201  0.0501 -0.0779 -0.2924 
gamma
        pFood1    pFood2    pFood3   pFood4
wFood1  0.0976 -0.142578 -0.010547  0.05551
wFood2 -0.1426  0.157784 -0.000515 -0.01469
wFood3 -0.0105 -0.000515  0.015220 -0.00416
wFood4  0.0555 -0.014692 -0.004159 -0.03666
> print( summary( estResultAIDS, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.240  0.120  0.267  0.854 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3201  0.0501 -0.0779 -0.2924 
gamma
        pFood1    pFood2    pFood3   pFood4
wFood1  0.0976 -0.142578 -0.010547  0.05551
wFood2 -0.1426  0.157784 -0.000515 -0.01469
wFood3 -0.0105 -0.000515  0.015220 -0.00416
wFood4  0.0555 -0.014692 -0.004159 -0.03666

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.030  1.249  0.419  0.174 

Marshallian (uncompensated) Price Elasticities
        pFood1  pFood2  pFood3 pFood4
wFood1 -0.4419 -0.5795 -0.3092 -0.700
wFood2 -0.6494 -0.2452 -0.0691 -0.285
wFood3 -0.2162  0.0642 -0.7314  0.464
wFood4 -0.0389  0.0553  0.2090 -0.399

Hicksian (compensated) Price Elasticities
        pFood1   pFood2  pFood3  pFood4
wFood1  0.1890 -0.17095 -0.0369  0.0190
wFood2 -0.2612  0.00618  0.0984  0.1567
wFood3 -0.0858  0.14863 -0.6751  0.6123
wFood4  0.0151  0.09031  0.2324 -0.3378
> # imposing restrictions via TX
> estResultAIDSTX <- aidsEst( pNames, wNames, "xFood",
+    data = Blanciforti86[ setWo1, ], ILmaxiter = 1,
+    ILtol=1e-7,
+    method = "IL:L", TX = TRUE )
> print( estResultAIDSTX )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.240  0.120  0.267  0.854 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3201  0.0501 -0.0779 -0.2924 
gamma
        pFood1    pFood2    pFood3   pFood4
wFood1  0.0976 -0.142578 -0.010547  0.05551
wFood2 -0.1426  0.157784 -0.000515 -0.01469
wFood3 -0.0105 -0.000515  0.015220 -0.00416
wFood4  0.0555 -0.014692 -0.004159 -0.03666
> print( summary( estResultAIDSTX, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.240  0.120  0.267  0.854 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3201  0.0501 -0.0779 -0.2924 
gamma
        pFood1    pFood2    pFood3   pFood4
wFood1  0.0976 -0.142578 -0.010547  0.05551
wFood2 -0.1426  0.157784 -0.000515 -0.01469
wFood3 -0.0105 -0.000515  0.015220 -0.00416
wFood4  0.0555 -0.014692 -0.004159 -0.03666

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.030  1.249  0.419  0.174 

Marshallian (uncompensated) Price Elasticities
        pFood1  pFood2  pFood3 pFood4
wFood1 -0.4419 -0.5795 -0.3092 -0.700
wFood2 -0.6494 -0.2452 -0.0691 -0.285
wFood3 -0.2162  0.0642 -0.7314  0.464
wFood4 -0.0389  0.0553  0.2090 -0.399

Hicksian (compensated) Price Elasticities
        pFood1   pFood2  pFood3  pFood4
wFood1  0.1890 -0.17095 -0.0369  0.0190
wFood2 -0.2612  0.00618  0.0984  0.1567
wFood3 -0.0858  0.14863 -0.6751  0.6123
wFood4  0.0151  0.09031  0.2324 -0.3378
> estResultAIDSTX$call <- NULL
> estResultAIDSTX$est$bt <- NULL
> estResultAIDSTX$est$btcov <- NULL
> estResultAIDSTX$est$x <- NULL
> estResultAIDSTX$est$TX <- NULL
> estResultAIDSTX$est$q.restr <- NULL
> estResultAIDS$call <- NULL
> estResultAIDS$est$x <- NULL
> estResultAIDS$est$R.restr <- NULL
> estResultAIDS$est$q.restr <- NULL
> print( all.equal( estResultAIDS, estResultAIDSTX ) )
[1] TRUE
> 
> ## only homogeneity (no symmetry imposed)
> estResultAIDShom <- aidsEst( pNames, wNames, "xFood", sym = FALSE,
+    data = Blanciforti86[ setWo1, ], ILmaxiter = 1,
+    ILtol=1e-7,
+    method = "IL:L" )
> print( estResultAIDShom )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.2614  0.0978  0.2507  0.9128 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3332  0.0619 -0.0691 -0.3259 
gamma
         pFood1  pFood2  pFood3   pFood4
wFood1  0.09999 -0.1332 -0.0469  0.08011
wFood2 -0.13298  0.1242  0.0305 -0.02172
wFood3 -0.00427 -0.0207  0.0310 -0.00603
wFood4  0.03727  0.0297 -0.0146 -0.05237
> print( summary( estResultAIDShom, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.2614  0.0978  0.2507  0.9128 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3332  0.0619 -0.0691 -0.3259 
gamma
         pFood1  pFood2  pFood3   pFood4
wFood1  0.09999 -0.1332 -0.0469  0.08011
wFood2 -0.13298  0.1242  0.0305 -0.02172
wFood3 -0.00427 -0.0207  0.0310 -0.00603
wFood4  0.03727  0.0297 -0.0146 -0.05237

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.072  1.308  0.485  0.079 

Marshallian (uncompensated) Price Elasticities
       pFood1 pFood2 pFood3 pFood4
wFood1 -0.400 -0.533 -0.421 -0.718
wFood2 -0.581 -0.413  0.074 -0.388
wFood3 -0.165 -0.104 -0.639  0.424
wFood4 -0.133  0.173  0.191 -0.310

Hicksian (compensated) Price Elasticities
        pFood1   pFood2 pFood3  pFood4
wFood1  0.2436 -0.11562 -0.143  0.0156
wFood2 -0.1747 -0.14966  0.249  0.0750
wFood3 -0.0149 -0.00646 -0.574  0.5955
wFood4 -0.1088  0.18913  0.202 -0.2820
> # imposing restrictions via TX
> estResultAIDShomTX <- aidsEst( pNames, wNames, "xFood", sym = FALSE,
+    data = Blanciforti86[ setWo1, ], ILmaxiter = 1,
+    ILtol=1e-7,
+    method = "IL:L", TX = TRUE )
> print( estResultAIDShomTX )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.2614  0.0978  0.2507  0.9128 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3332  0.0619 -0.0691 -0.3259 
gamma
         pFood1  pFood2  pFood3   pFood4
wFood1  0.09999 -0.1332 -0.0469  0.08011
wFood2 -0.13298  0.1242  0.0305 -0.02172
wFood3 -0.00427 -0.0207  0.0310 -0.00603
wFood4  0.03727  0.0297 -0.0146 -0.05237
> print( summary( estResultAIDShomTX, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.2614  0.0978  0.2507  0.9128 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3332  0.0619 -0.0691 -0.3259 
gamma
         pFood1  pFood2  pFood3   pFood4
wFood1  0.09999 -0.1332 -0.0469  0.08011
wFood2 -0.13298  0.1242  0.0305 -0.02172
wFood3 -0.00427 -0.0207  0.0310 -0.00603
wFood4  0.03727  0.0297 -0.0146 -0.05237

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.072  1.308  0.485  0.079 

Marshallian (uncompensated) Price Elasticities
       pFood1 pFood2 pFood3 pFood4
wFood1 -0.400 -0.533 -0.421 -0.718
wFood2 -0.581 -0.413  0.074 -0.388
wFood3 -0.165 -0.104 -0.639  0.424
wFood4 -0.133  0.173  0.191 -0.310

Hicksian (compensated) Price Elasticities
        pFood1   pFood2 pFood3  pFood4
wFood1  0.2436 -0.11562 -0.143  0.0156
wFood2 -0.1747 -0.14966  0.249  0.0750
wFood3 -0.0149 -0.00646 -0.574  0.5955
wFood4 -0.1088  0.18913  0.202 -0.2820
> estResultAIDShomTX$call <- NULL
> estResultAIDShomTX$est$bt <- NULL
> estResultAIDShomTX$est$btcov <- NULL
> estResultAIDShomTX$est$x <- NULL
> estResultAIDShomTX$est$TX <- NULL
> estResultAIDShomTX$est$q.restr <- NULL
> estResultAIDShom$call <- NULL
> estResultAIDShom$est$x <- NULL
> estResultAIDShom$est$R.restr <- NULL
> estResultAIDShom$est$q.restr <- NULL
> print( all.equal( estResultAIDShom, estResultAIDShomTX ) )
[1] TRUE
> 
> ## unrestricted (no homogeneity and no symmetry imposed)
> estResultAIDSunr <- aidsEst( pNames, wNames, "xFood", hom = FALSE, sym = FALSE,
+    data = Blanciforti86[ setWo1, ], ILmaxiter = 1,
+    ILtol=1e-7,
+    method = "IL:L" )
> print( estResultAIDSunr )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.0739  0.1649  0.2491  0.6599 
beta
  wFood1   wFood2   wFood3   wFood4 
 0.14281 -0.00618 -0.06746 -0.06917 
gamma
         pFood1  pFood2   pFood3   pFood4
wFood1  0.11747 -0.0491 -0.05497  0.01854
wFood2 -0.12673  0.1543  0.02763 -0.04373
wFood3 -0.00443 -0.0214  0.03103 -0.00548
wFood4  0.01369 -0.0838 -0.00369  0.03068
> print( summary( estResultAIDSunr, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.0739  0.1649  0.2491  0.6599 
beta
  wFood1   wFood2   wFood3   wFood4 
 0.14281 -0.00618 -0.06746 -0.06917 
gamma
         pFood1  pFood2   pFood3   pFood4
wFood1  0.11747 -0.0491 -0.05497  0.01854
wFood2 -0.12673  0.1543  0.02763 -0.04373
wFood3 -0.00443 -0.0214  0.03103 -0.00548
wFood4  0.01369 -0.0838 -0.00369  0.03068

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 1.460  0.969  0.497  0.805 

Marshallian (uncompensated) Price Elasticities
          pFood1 pFood2  pFood3 pFood4
wFood1 -0.652904 -0.256 -0.2915 -0.156
wFood2 -0.627634 -0.227  0.1450 -0.203
wFood3  0.000814 -0.052 -0.6432  0.195
wFood4  0.051818 -0.195  0.0383 -0.822

Hicksian (compensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.199  0.0375 -0.0957  0.360
wFood2 -0.326 -0.0319  0.2750  0.140
wFood3  0.155  0.0480 -0.5766  0.371
wFood4  0.302 -0.0329  0.1462 -0.537
> # imposing restrictions via TX
> estResultAIDSunrTX <- aidsEst( pNames, wNames, "xFood", hom = FALSE, sym = FALSE,
+    data = Blanciforti86[ setWo1, ], ILmaxiter = 1,
+    ILtol=1e-7,
+    method = "IL:L", TX = TRUE )
> print( estResultAIDSunrTX )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.0739  0.1649  0.2491  0.6599 
beta
  wFood1   wFood2   wFood3   wFood4 
 0.14281 -0.00618 -0.06746 -0.06917 
gamma
         pFood1  pFood2   pFood3   pFood4
wFood1  0.11747 -0.0491 -0.05497  0.01854
wFood2 -0.12673  0.1543  0.02763 -0.04373
wFood3 -0.00443 -0.0214  0.03103 -0.00548
wFood4  0.01369 -0.0838 -0.00369  0.03068
> print( summary( estResultAIDSunrTX, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
 wFood1  wFood2  wFood3  wFood4 
-0.0739  0.1649  0.2491  0.6599 
beta
  wFood1   wFood2   wFood3   wFood4 
 0.14281 -0.00618 -0.06746 -0.06917 
gamma
         pFood1  pFood2   pFood3   pFood4
wFood1  0.11747 -0.0491 -0.05497  0.01854
wFood2 -0.12673  0.1543  0.02763 -0.04373
wFood3 -0.00443 -0.0214  0.03103 -0.00548
wFood4  0.01369 -0.0838 -0.00369  0.03068

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 1.460  0.969  0.497  0.805 

Marshallian (uncompensated) Price Elasticities
          pFood1 pFood2  pFood3 pFood4
wFood1 -0.652904 -0.256 -0.2915 -0.156
wFood2 -0.627634 -0.227  0.1450 -0.203
wFood3  0.000814 -0.052 -0.6432  0.195
wFood4  0.051818 -0.195  0.0383 -0.822

Hicksian (compensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.199  0.0375 -0.0957  0.360
wFood2 -0.326 -0.0319  0.2750  0.140
wFood3  0.155  0.0480 -0.5766  0.371
wFood4  0.302 -0.0329  0.1462 -0.537
> estResultAIDSunrTX$call <- NULL
> estResultAIDSunrTX$est$bt <- NULL
> estResultAIDSunrTX$est$btcov <- NULL
> estResultAIDSunrTX$est$x <- NULL
> estResultAIDSunrTX$est$TX <- NULL
> estResultAIDSunrTX$est$q.restr <- NULL
> estResultAIDSunr$call <- NULL
> estResultAIDSunr$est$x <- NULL
> estResultAIDSunr$est$R.restr <- NULL
> estResultAIDSunr$est$q.restr <- NULL
> print( all.equal( estResultAIDSunr, estResultAIDSunrTX ) )
[1] TRUE
> 
> ## with NAs
> estResultLaSNa <- aidsEst( pNames, wNames, "xFood",
+    data = Blanciforti86,
+    method = "LA:S" )
Warning message:
there are some NAs in the data, all observations (rows) with NAs are excluded from the analysis in: aidsEst(pNames, wNames, "xFood", data = Blanciforti86, method = "LA:S") 
> print( estResultLaSNa )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with Stone Index (S)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.247  0.109  0.268  0.870 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3240  0.0559 -0.0786 -0.3012 
gamma
        pFood1   pFood2   pFood3  pFood4
wFood1  0.1042 -0.13988 -0.01156  0.0473
wFood2 -0.1399  0.15691  0.00347 -0.0205
wFood3 -0.0116  0.00347  0.01249 -0.0044
wFood4  0.0473 -0.02050 -0.00440 -0.0224
> print( summary( estResultLaSNa, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with Stone Index (S)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.247  0.109  0.268  0.870 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3240  0.0559 -0.0786 -0.3012 
gamma
        pFood1   pFood2   pFood3  pFood4
wFood1  0.1042 -0.13988 -0.01156  0.0473
wFood2 -0.1399  0.15691  0.00347 -0.0205
wFood3 -0.0116  0.00347  0.01249 -0.0044
wFood4  0.0473 -0.02050 -0.00440 -0.0224

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.044  1.279  0.414  0.152 

Marshallian (uncompensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.409 -0.5619 -0.3176 -0.755
wFood2 -0.630 -0.2465 -0.0576 -0.345
wFood3 -0.229  0.0883 -0.7494  0.477
wFood4 -0.074  0.0326  0.2154 -0.326

Hicksian (compensated) Price Elasticities
        pFood1  pFood2  pFood3  pFood4
wFood1  0.2249 -0.1524 -0.0435 -0.0288
wFood2 -0.2332  0.0097  0.1140  0.1096
wFood3 -0.1010  0.1712 -0.6939  0.6237
wFood4 -0.0268  0.0631  0.2358 -0.2721
> 
> estResultLaSlNa <- aidsEst( pNames, wNames, "xFood",
+    data = Blanciforti86,
+    method = "LA:SL" )
Warning message:
there are some NAs in the data, all observations (rows) with NAs are excluded from the analysis in: aidsEst(pNames, wNames, "xFood", data = Blanciforti86, method = "LA:SL") 
> print( estResultLaSlNa )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.255  0.110  0.261  0.884 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3287  0.0559 -0.0747 -0.3099 
gamma
        pFood1   pFood2    pFood3    pFood4
wFood1  0.1107 -0.13851 -0.011881  0.039732
wFood2 -0.1385  0.15820 -0.003476 -0.016216
wFood3 -0.0119 -0.00348  0.014589  0.000768
wFood4  0.0397 -0.01622  0.000768 -0.024285
> print( summary( estResultLaSlNa, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with lagged Stone Index (SL)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.255  0.110  0.261  0.884 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3287  0.0559 -0.0747 -0.3099 
gamma
        pFood1   pFood2    pFood3    pFood4
wFood1  0.1107 -0.13851 -0.011881  0.039732
wFood2 -0.1385  0.15820 -0.003476 -0.016216
wFood3 -0.0119 -0.00348  0.014589  0.000768
wFood4  0.0397 -0.01622  0.000768 -0.024285

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.058  1.278  0.443  0.124 

Marshallian (uncompensated) Price Elasticities
       pFood1  pFood2  pFood3 pFood4
wFood1 -0.377 -0.5591 -0.3153 -0.806
wFood2 -0.618 -0.2437 -0.0901 -0.326
wFood3 -0.229  0.0338 -0.7452  0.498
wFood4 -0.108  0.0480  0.2316 -0.295

Hicksian (compensated) Price Elasticities
        pFood1  pFood2  pFood3  pFood4
wFood1  0.2622 -0.1449 -0.0393 -0.0778
wFood2 -0.2210  0.0135  0.0813  0.1263
wFood3 -0.0914  0.1229 -0.6859  0.6544
wFood4 -0.0698  0.0731  0.2483 -0.2515
> 
> estResultLaLNa <- aidsEst( pNames, wNames, "xFood",
+    data = Blanciforti86,
+    method = "LA:L" )
Warning message:
there are some NAs in the data, all observations (rows) with NAs are excluded from the analysis in: aidsEst(pNames, wNames, "xFood", data = Blanciforti86, method = "LA:L") 
> print( estResultLaLNa )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with Laspeyres Index (L)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.248  0.123  0.273  0.852 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3251  0.0481 -0.0816 -0.2917 
gamma
         pFood1   pFood2   pFood3  pFood4
wFood1  0.09104 -0.14571 -0.00963  0.0643
wFood2 -0.14571  0.15852  0.00594 -0.0188
wFood3 -0.00963  0.00594  0.01289 -0.0092
wFood4  0.06431 -0.01875 -0.00920 -0.0364
> print( summary( estResultLaLNa, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: Linear Approximation (LA) with Laspeyres Index (L)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.248  0.123  0.273  0.852 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3251  0.0481 -0.0816 -0.2917 
gamma
         pFood1   pFood2   pFood3  pFood4
wFood1  0.09104 -0.14571 -0.00963  0.0643
wFood2 -0.14571  0.15852  0.00594 -0.0188
wFood3 -0.00963  0.00594  0.01289 -0.0092
wFood4  0.06431 -0.01875 -0.00920 -0.0364

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.048  1.240  0.392  0.179 

Marshallian (uncompensated) Price Elasticities
        pFood1  pFood2  pFood3 pFood4
wFood1 -0.4507 -0.5953 -0.3172 -0.684
wFood2 -0.6687 -0.2376 -0.0359 -0.298
wFood3 -0.2204  0.1173 -0.7378  0.449
wFood4 -0.0196  0.0459  0.1984 -0.404

Hicksian (compensated) Price Elasticities
        pFood1  pFood2  pFood3  pFood4
wFood1  0.1848 -0.1851 -0.0425  0.0431
wFood2 -0.2838  0.0109  0.1304  0.1426
wFood3 -0.0987  0.1959 -0.6852  0.5881
wFood4  0.0360  0.0817  0.2224 -0.3400
> 
> estResultAIDSNa <- aidsEst( pNames, wNames, "xFood",
+    data = Blanciforti86, ILmaxiter = 1,
+    ILtol=1e-7, method = "IL:L" )
Warning message:
there are some NAs in the data, all observations (rows) with NAs are excluded from the analysis in: aidsEst(pNames, wNames, "xFood", data = Blanciforti86, ILmaxiter = 1,  
> print( estResultAIDSNa )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.248  0.123  0.273  0.852 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3251  0.0481 -0.0816 -0.2917 
gamma
         pFood1   pFood2   pFood3  pFood4
wFood1  0.09104 -0.14571 -0.00963  0.0643
wFood2 -0.14571  0.15852  0.00594 -0.0188
wFood3 -0.00963  0.00594  0.01289 -0.0092
wFood4  0.06431 -0.01875 -0.00920 -0.0364
> print( summary( estResultAIDSNa, elaFormula = "AIDS", quantNames = wNames ) )

Demand analysis with the Almost Ideal Demand System (AIDS)
Estimation Method: 'Iterated Linear Least Squares Estimator' (IL) starting with Laspeyres Index (L)
Estimated Coefficients:
alpha
wFood1 wFood2 wFood3 wFood4 
-0.248  0.123  0.273  0.852 
beta
 wFood1  wFood2  wFood3  wFood4 
 0.3251  0.0481 -0.0816 -0.2917 
gamma
         pFood1   pFood2   pFood3  pFood4
wFood1  0.09104 -0.14571 -0.00963  0.0643
wFood2 -0.14571  0.15852  0.00594 -0.0188
wFood3 -0.00963  0.00594  0.01289 -0.0092
wFood4  0.06431 -0.01875 -0.00920 -0.0364

Demand Elasticities (original AIDS formula)
Expenditure Elasticities
wFood1 wFood2 wFood3 wFood4 
 2.048  1.240  0.392  0.179 

Marshallian (uncompensated) Price Elasticities
        pFood1  pFood2  pFood3 pFood4
wFood1 -0.4507 -0.5953 -0.3172 -0.684
wFood2 -0.6687 -0.2376 -0.0359 -0.298
wFood3 -0.2204  0.1173 -0.7378  0.449
wFood4 -0.0196  0.0459  0.1984 -0.404

Hicksian (compensated) Price Elasticities
        pFood1  pFood2  pFood3  pFood4
wFood1  0.1848 -0.1851 -0.0425  0.0431
wFood2 -0.2838  0.0109  0.1304  0.1426
wFood3 -0.0987  0.1959 -0.6852  0.5881
wFood4  0.0360  0.0817  0.2224 -0.3400
> 
> 
> ########## Elasticities ###############
> cat( "\nAIDS: Elasticities\n" )

AIDS: Elasticities
> wMeans <- colMeans( Blanciforti86[ set, wNames ] )
> ela <- aidsEla( estResultAIDS$coef, wMeans, pMeans, formula = "AIDS" )
> print( ela )
$formula
[1] "AIDS"

$exp
q_wFood1 q_wFood2 q_wFood3 q_wFood4 
   2.031    1.250    0.419    0.177 

$hicks
          pFood1   pFood2  pFood3  pFood4
q_wFood1  0.1891 -0.17300 -0.0371  0.0212
q_wFood2 -0.2644  0.00878  0.0983  0.1575
q_wFood3 -0.0859  0.14808 -0.6751  0.6130
q_wFood4  0.0164  0.09034  0.2319 -0.3386

$marshall
          pFood1  pFood2  pFood3 pFood4
q_wFood1 -0.4414 -0.5800 -0.3096 -0.700
q_wFood2 -0.6524 -0.2417 -0.0694 -0.287
q_wFood3 -0.2160  0.0641 -0.7314  0.464
q_wFood4 -0.0385  0.0549  0.2082 -0.401

attr(,"class")
[1] "aidsEla"
> elaTX <- aidsEla( estResultAIDSTX$coef, wMeans, pMeans, formula = "AIDS" )
> print( elaTX )
$formula
[1] "AIDS"

$exp
q_wFood1 q_wFood2 q_wFood3 q_wFood4 
   2.031    1.250    0.419    0.177 

$hicks
          pFood1   pFood2  pFood3  pFood4
q_wFood1  0.1891 -0.17300 -0.0371  0.0212
q_wFood2 -0.2644  0.00878  0.0983  0.1575
q_wFood3 -0.0859  0.14808 -0.6751  0.6130
q_wFood4  0.0164  0.09034  0.2319 -0.3386

$marshall
          pFood1  pFood2  pFood3 pFood4
q_wFood1 -0.4414 -0.5800 -0.3096 -0.700
q_wFood2 -0.6524 -0.2417 -0.0694 -0.287
q_wFood3 -0.2160  0.0641 -0.7314  0.464
q_wFood4 -0.0385  0.0549  0.2082 -0.401

attr(,"class")
[1] "aidsEla"
> print( all.equal( ela, elaTX ) )
[1] TRUE
> 
> 
> cat( "\nLA: Elasticity formula of non-linear AIDS\n" )

LA: Elasticity formula of non-linear AIDS
> wMeans <- colMeans( Blanciforti86[ set, wNames ] )
> ela <- aidsEla( estResultLA$coef, wMeans, pMeans, formula = "AIDS" )
> print( ela )
$formula
[1] "AIDS"

$exp
q_wFood1 q_wFood2 q_wFood3 q_wFood4 
   2.059    1.279    0.443    0.128 

$hicks
          pFood1  pFood2  pFood3  pFood4
q_wFood1  0.2623 -0.1470 -0.0395 -0.0756
q_wFood2 -0.2240  0.0161  0.0811  0.1270
q_wFood3 -0.0915  0.1224 -0.6859  0.6550
q_wFood4 -0.0682  0.0732  0.2478 -0.2528

$marshall
         pFood1  pFood2  pFood3 pFood4
q_wFood1 -0.377 -0.5595 -0.3157 -0.807
q_wFood2 -0.621 -0.2402 -0.0905 -0.328
q_wFood3 -0.229  0.0337 -0.7453  0.498
q_wFood4 -0.108  0.0476  0.2307 -0.298

attr(,"class")
[1] "aidsEla"
> elaTX <- aidsEla( estResultLATX$coef, wMeans, pMeans, formula = "AIDS" )
> print( elaTX )
$formula
[1] "AIDS"

$exp
q_wFood1 q_wFood2 q_wFood3 q_wFood4 
   2.059    1.279    0.443    0.128 

$hicks
          pFood1  pFood2  pFood3  pFood4
q_wFood1  0.2623 -0.1470 -0.0395 -0.0756
q_wFood2 -0.2240  0.0161  0.0811  0.1270
q_wFood3 -0.0915  0.1224 -0.6859  0.6550
q_wFood4 -0.0682  0.0732  0.2478 -0.2528

$marshall
         pFood1  pFood2  pFood3 pFood4
q_wFood1 -0.377 -0.5595 -0.3157 -0.807
q_wFood2 -0.621 -0.2402 -0.0905 -0.328
q_wFood3 -0.229  0.0337 -0.7453  0.498
q_wFood4 -0.108  0.0476  0.2307 -0.298

attr(,"class")
[1] "aidsEla"
> print( all.equal( ela, elaTX ) )
[1] TRUE
> 
> cat( "\n********** Elasticities ***************" )

********** Elasticities ***************> cat( "\nLA: Elasticity formula of Chalfant / Goddard\n" )

LA: Elasticity formula of Chalfant / Goddard
> ela <- aidsEla( estResultLA$coef, wMeans, formula = "Ch" )
> print( ela )
$formula
[1] "Ch"

$exp
q_wFood1 q_wFood2 q_wFood3 q_wFood4 
   2.059    1.279    0.443    0.128 

$hicks
         pFood1 pFood2  pFood3 pFood4
q_wFood1 -0.333 -0.246  0.0958  0.483
q_wFood2 -0.381 -0.010  0.1168  0.274
q_wFood3  0.222  0.174 -0.7571  0.361
q_wFood4  0.422  0.155  0.1363 -0.713

$marshall
          pFood1  pFood2  pFood3 pFood4
q_wFood1 -0.9722 -0.6584 -0.1803 -0.248
q_wFood2 -0.7780 -0.2663 -0.0548 -0.180
q_wFood3  0.0844  0.0857 -0.8165  0.204
q_wFood4  0.3826  0.1291  0.1192 -0.758

attr(,"class")
[1] "aidsEla"
> 
> cat( "\nLA: Elasticity formula of Eales + Unnevehr\n" )

LA: Elasticity formula of Eales + Unnevehr
> wMeans <- colMeans( Blanciforti86[ set, wNames ] )
> ela <- aidsEla( estResultLA$coef, wMeans, formula = "EU" )
> print( ela )
$formula
[1] "EU"

$exp
q_wFood1 q_wFood2 q_wFood3 q_wFood4 
   2.059    1.279    0.443    0.128 

$marshall
          pFood1  pFood2   pFood3   pFood4
q_wFood1 -0.6435 -0.4463 -0.03828  0.12801
q_wFood2 -0.6914 -0.2103 -0.01735 -0.08094
q_wFood3 -0.0886 -0.0259 -0.89123  0.00573
q_wFood4  0.1118 -0.0456  0.00216 -1.06836

$hicks
           pFood1  pFood2  pFood3 pFood4
q_wFood1 -0.00439 -0.0338  0.2379  0.859
q_wFood2 -0.29432  0.0459  0.1542  0.374
q_wFood3  0.04884  0.0628 -0.8318  0.163
q_wFood4  0.15146 -0.0201  0.0193 -1.023

attr(,"class")
[1] "aidsEla"
> 
> 
> ############# Price indices ##############
> options( digits = 5 )
> cat( "\n************** Price indices **************\n" )

************** Price indices **************
> cat( "\nStone index\n" )

Stone index
> pxS <- aidsPx( "S", pNames, wNames, Blanciforti86 )
> print( pxS )
 [1] 4.0453 4.1253 4.0850 4.1068 4.2053 4.2255 4.2187 4.2221 4.2000 4.2050
[11] 4.2372 4.2728 4.2551 4.2663 4.2815 4.2884 4.3078 4.3188 4.3374 4.3881
[21] 4.4015 4.4357 4.4797 4.5305 4.5703 4.6052 4.7429 4.8765 4.9622 4.9943
[31] 5.0585 5.1532     NA     NA     NA
> 
> cat( "\nStone index with lagged shares\n" )

Stone index with lagged shares
> pxSL <- aidsPx( "SL", pNames, wNames, Blanciforti86 )
> print( pxSL )
 [1]     NA 4.1280 4.0861 4.1003 4.2153 4.2211 4.2183 4.2186 4.2042 4.2038
[11] 4.2377 4.2727 4.2549 4.2663 4.2816 4.2885 4.3035 4.3226 4.3376 4.3886
[21] 4.3964 4.4358 4.4845 4.5351 4.5619 4.6098 4.7409 4.8760 4.9610 5.0007
[31] 5.0565 5.1498     NA     NA     NA
> 
> cat( "\nPaasche index\n" )

Paasche index
> pxP <- aidsPx( "P", pNames, wNames, Blanciforti86 )
> print( pxP )
 [1] 0.000000 0.083512 0.044760 0.061564 0.168431 0.184889 0.177701 0.177342
 [9] 0.160284 0.165760 0.198634 0.233756 0.216878 0.228398 0.243559 0.250609
[17] 0.265651 0.281360 0.299877 0.348917 0.359147 0.393046 0.439949 0.494065
[25] 0.527593 0.564467 0.701564 0.836062 0.923102 0.958894 1.024138 1.114765
[33]       NA       NA       NA
> 
> cat( "\nLaspeyres index\n" )

Laspeyres index
> pxL <- aidsPx( "L", pNames, wNames, Blanciforti86 )
> print( pxL )
 [1] 4.0453 4.1280 4.0892 4.1045 4.2133 4.2289 4.2239 4.2245 4.2073 4.2106
[11] 4.2443 4.2769 4.2594 4.2707 4.2868 4.2932 4.3065 4.3210 4.3399 4.3923
[21] 4.4030 4.4357 4.4857 4.5429 4.5750 4.6098 4.7374 4.8813 4.9690 5.0129
[31] 5.0817 5.1668     NA     NA     NA
> 
> cat( "\nTornqvist index\n" )

Tornqvist index
> pxT <- aidsPx( "T", pNames, wNames, Blanciforti86 )
> print( pxT )
 [1] 0.000000 0.083092 0.044319 0.060364 0.168221 0.184263 0.178128 0.178274
 [9] 0.161126 0.165537 0.198788 0.232696 0.215461 0.226871 0.242525 0.249244
[17] 0.263432 0.278527 0.297256 0.347963 0.358424 0.391724 0.440184 0.495828
[25] 0.528650 0.564467 0.696816 0.836045 0.923408 0.963260 1.030242 1.118122
[33]       NA       NA       NA
> 
> cat( "\nTranslog index\n" )

Translog index
> pxTL <- aidsPx( "TL", pNames, wNames, Blanciforti86,
+    coef = estResultLA$coef )
> print( pxTL )
 [1] 4.0181 4.0769 4.0359 4.0435 4.1570 4.1705 4.2183 4.2387 4.2513 4.2870
[11] 4.2872 4.2582 4.2588 4.2883 4.3193 4.3088 4.3373 4.3742 4.3577 4.3902
[21] 4.4379 4.4704 4.5018 4.5715 4.6248 4.6052 4.6426 4.8924 4.9988 5.0830
[31] 5.2161 5.2321     NA     NA     NA
> 
> ########### fitted values #################
> options( digits = 3 )
> fittedAIDS <- aidsCalc( pNames, "xFood", Blanciforti86[ -1, ],
+    coef = estResultAIDS$coef )
> print( fittedAIDS )
$shares
        w1    w2    w3    w4
1948 0.333 0.175 0.131 0.360
1949 0.324 0.186 0.132 0.358
1950 0.332 0.173 0.132 0.363
1951 0.333 0.168 0.133 0.366
1952 0.322 0.185 0.132 0.361
1953 0.308 0.185 0.137 0.370
1954 0.295 0.183 0.140 0.382
1955 0.285 0.194 0.142 0.379
1956 0.269 0.207 0.144 0.380
1957 0.284 0.196 0.142 0.378
1958 0.299 0.197 0.137 0.367
1959 0.300 0.200 0.137 0.363
1960 0.294 0.205 0.138 0.363
1961 0.288 0.204 0.139 0.369
1962 0.298 0.204 0.137 0.361
1963 0.287 0.214 0.138 0.361
1964 0.277 0.221 0.139 0.363
1965 0.297 0.214 0.135 0.354
1966 0.313 0.206 0.133 0.348
1967 0.306 0.208 0.135 0.351
1968 0.303 0.217 0.134 0.346
1969 0.318 0.208 0.131 0.343
1970 0.317 0.205 0.132 0.345
1971 0.302 0.210 0.135 0.353
1972 0.327 0.208 0.129 0.336
1973 0.362 0.201 0.121 0.317
1974 0.313 0.213 0.132 0.342
1975 0.312 0.203 0.135 0.350
1976 0.306 0.203 0.136 0.355
1977 0.268 0.210 0.144 0.378
1978 0.296 0.209 0.137 0.359
1979    NA    NA    NA    NA
1980    NA    NA    NA    NA
1981    NA    NA    NA    NA

$quant
       q1    q2    q3   q4
1948 1.61 1.032 0.746 1.89
1949 1.60 1.046 0.728 1.93
1950 1.56 1.009 0.716 1.91
1951 1.55 0.995 0.729 1.89
1952 1.55 1.023 0.728 1.92
1953 1.57 1.057 0.737 1.90
1954 1.49 1.034 0.723 1.88
1955 1.55 1.092 0.725 1.91
1956 1.56 1.129 0.737 1.91
1957 1.55 1.095 0.715 1.92
1958 1.54 1.057 0.697 1.96
1959 1.62 1.106 0.697 1.97
1960 1.64 1.130 0.704 1.98
1961 1.61 1.126 0.704 1.96
1962 1.67 1.139 0.692 1.99
1963 1.67 1.158 0.702 2.00
1964 1.66 1.173 0.720 1.99
1965 1.73 1.171 0.710 2.00
1966 1.78 1.173 0.710 2.00
1967 1.83 1.217 0.723 1.99
1968 1.85 1.231 0.746 1.99
1969 1.89 1.223 0.750 1.97
1970 1.90 1.233 0.760 1.96
1971 1.84 1.227 0.758 1.95
1972 1.92 1.223 0.756 1.97
1973 1.94 1.180 0.726 2.00
1974 1.87 1.227 0.700 2.03
1975 1.85 1.223 0.692 2.02
1976 1.90 1.256 0.753 1.95
1977 1.72 1.229 0.806 1.87
1978 1.81 1.220 0.781 1.92
1979   NA    NA    NA   NA
1980   NA    NA    NA   NA
1981   NA    NA    NA   NA

> if( max( abs( fittedAIDS$shares[ !is.na( fittedAIDS$shares ) ] -
+    estResultAIDS$wFitted ) ) > 1e-5 ) {
+    stop( "fitted shares of AIDS are wrong" )
+ }
> if( max( abs( fittedAIDS$quant[ !is.na( fittedAIDS$quant ) ] -
+    estResultAIDS$qFitted ) ) > 1e-5 ) {
+    stop( "fitted quantities of AIDS are wrong" )
+ }
> fittedAIDSTX <- aidsCalc( pNames, "xFood", Blanciforti86[ -1, ],
+    coef = estResultAIDSTX$coef )
> print( fittedAIDSTX )
$shares
        w1    w2    w3    w4
1948 0.333 0.175 0.131 0.360
1949 0.324 0.186 0.132 0.358
1950 0.332 0.173 0.132 0.363
1951 0.333 0.168 0.133 0.366
1952 0.322 0.185 0.132 0.361
1953 0.308 0.185 0.137 0.370
1954 0.295 0.183 0.140 0.382
1955 0.285 0.194 0.142 0.379
1956 0.269 0.207 0.144 0.380
1957 0.284 0.196 0.142 0.378
1958 0.299 0.197 0.137 0.367
1959 0.300 0.200 0.137 0.363
1960 0.294 0.205 0.138 0.363
1961 0.288 0.204 0.139 0.369
1962 0.298 0.204 0.137 0.361
1963 0.287 0.214 0.138 0.361
1964 0.277 0.221 0.139 0.363
1965 0.297 0.214 0.135 0.354
1966 0.313 0.206 0.133 0.348
1967 0.306 0.208 0.135 0.351
1968 0.303 0.217 0.134 0.346
1969 0.318 0.208 0.131 0.343
1970 0.317 0.205 0.132 0.345
1971 0.302 0.210 0.135 0.353
1972 0.327 0.208 0.129 0.336
1973 0.362 0.201 0.121 0.317
1974 0.313 0.213 0.132 0.342
1975 0.312 0.203 0.135 0.350
1976 0.306 0.203 0.136 0.355
1977 0.268 0.210 0.144 0.378
1978 0.296 0.209 0.137 0.359
1979    NA    NA    NA    NA
1980    NA    NA    NA    NA
1981    NA    NA    NA    NA

$quant
       q1    q2    q3   q4
1948 1.61 1.032 0.746 1.89
1949 1.60 1.046 0.728 1.93
1950 1.56 1.009 0.716 1.91
1951 1.55 0.995 0.729 1.89
1952 1.55 1.023 0.728 1.92
1953 1.57 1.057 0.737 1.90
1954 1.49 1.034 0.723 1.88
1955 1.55 1.092 0.725 1.91
1956 1.56 1.129 0.737 1.91
1957 1.55 1.095 0.715 1.92
1958 1.54 1.057 0.697 1.96
1959 1.62 1.106 0.697 1.97
1960 1.64 1.130 0.704 1.98
1961 1.61 1.126 0.704 1.96
1962 1.67 1.139 0.692 1.99
1963 1.67 1.158 0.702 2.00
1964 1.66 1.173 0.720 1.99
1965 1.73 1.171 0.710 2.00
1966 1.78 1.173 0.710 2.00
1967 1.83 1.217 0.723 1.99
1968 1.85 1.231 0.746 1.99
1969 1.89 1.223 0.750 1.97
1970 1.90 1.233 0.760 1.96
1971 1.84 1.227 0.758 1.95
1972 1.92 1.223 0.756 1.97
1973 1.94 1.180 0.726 2.00
1974 1.87 1.227 0.700 2.03
1975 1.85 1.223 0.692 2.02
1976 1.90 1.256 0.753 1.95
1977 1.72 1.229 0.806 1.87
1978 1.81 1.220 0.781 1.92
1979   NA    NA    NA   NA
1980   NA    NA    NA   NA
1981   NA    NA    NA   NA

> print( all.equal( fittedAIDS, fittedAIDSTX ) )
[1] TRUE
> 
> fittedLA <- aidsCalc( pNames, "xFood", Blanciforti86[ set, ],
+    coef = estResultLA$coef, lnp = estResultLA$lnp )
> print( fittedLA )
$shares
        w1    w2    w3    w4
1947    NA    NA    NA    NA
1948 0.317 0.173 0.135 0.374
1949 0.309 0.184 0.135 0.371
1950 0.315 0.170 0.136 0.378
1951 0.314 0.165 0.137 0.383
1952 0.306 0.183 0.136 0.375
1953 0.307 0.185 0.137 0.371
1954 0.299 0.183 0.139 0.378
1955 0.298 0.196 0.138 0.368
1956 0.292 0.210 0.138 0.360
1957 0.298 0.198 0.138 0.366
1958 0.295 0.196 0.138 0.372
1959 0.302 0.200 0.136 0.362
1960 0.301 0.206 0.136 0.357
1961 0.299 0.206 0.137 0.359
1962 0.304 0.204 0.135 0.356
1963 0.298 0.216 0.135 0.352
1964 0.292 0.223 0.135 0.350
1965 0.303 0.215 0.134 0.348
1966 0.314 0.207 0.133 0.347
1967 0.319 0.210 0.132 0.339
1968 0.313 0.219 0.131 0.336
1969 0.323 0.209 0.130 0.338
1970 0.328 0.207 0.130 0.335
1971 0.321 0.213 0.131 0.335
1972 0.326 0.209 0.129 0.337
1973 0.334 0.197 0.128 0.341
1974 0.319 0.214 0.131 0.336
1975 0.324 0.204 0.132 0.339
1976 0.330 0.206 0.131 0.333
1977 0.313 0.218 0.133 0.336
1978 0.320 0.213 0.131 0.336

$quant
       q1    q2    q3   q4
1947   NA    NA    NA   NA
1948 1.53 1.019 0.770 1.97
1949 1.52 1.033 0.748 2.00
1950 1.48 0.994 0.740 2.00
1951 1.46 0.979 0.754 1.97
1952 1.48 1.011 0.748 1.99
1953 1.56 1.056 0.738 1.90
1954 1.51 1.037 0.716 1.87
1955 1.62 1.102 0.708 1.85
1956 1.69 1.147 0.706 1.81
1957 1.63 1.105 0.698 1.86
1958 1.51 1.052 0.701 1.98
1959 1.63 1.106 0.695 1.97
1960 1.68 1.134 0.694 1.95
1961 1.67 1.134 0.690 1.91
1962 1.70 1.144 0.684 1.96
1963 1.73 1.165 0.688 1.95
1964 1.76 1.184 0.699 1.92
1965 1.76 1.176 0.701 1.97
1966 1.78 1.174 0.709 1.99
1967 1.91 1.229 0.707 1.92
1968 1.92 1.241 0.732 1.93
1969 1.92 1.229 0.744 1.94
1970 1.97 1.245 0.746 1.90
1971 1.95 1.245 0.733 1.86
1972 1.91 1.224 0.759 1.98
1973 1.79 1.158 0.769 2.16
1974 1.91 1.233 0.693 2.00
1975 1.92 1.233 0.678 1.95
1976 2.05 1.280 0.723 1.82
1977 2.01 1.271 0.744 1.66
1978 1.96 1.243 0.749 1.80

> if( max( abs( fittedLA$shares[ -1, ] - estResultLA$wFitted[ setWo1, ] ),
+       na.rm = TRUE ) > 1e-5 ) {
+    stop( "fitted shares of LA-AIDS are wrong" )
+ }
> if( max( abs( fittedLA$quant[ -1, ] - estResultLA$qFitted[ setWo1, ] ),
+       na.rm = TRUE ) > 1e-5 ) {
+    stop( "fitted quantities of LA-AIDS are wrong" )
+ }
> fittedLATX <- aidsCalc( pNames, "xFood", Blanciforti86[ set, ],
+    coef = estResultLATX$coef, lnp = estResultLATX$lnp )
> print( fittedLATX )
$shares
        w1    w2    w3    w4
1947    NA    NA    NA    NA
1948 0.317 0.173 0.135 0.374
1949 0.309 0.184 0.135 0.371
1950 0.315 0.170 0.136 0.378
1951 0.314 0.165 0.137 0.383
1952 0.306 0.183 0.136 0.375
1953 0.307 0.185 0.137 0.371
1954 0.299 0.183 0.139 0.378
1955 0.298 0.196 0.138 0.368
1956 0.292 0.210 0.138 0.360
1957 0.298 0.198 0.138 0.366
1958 0.295 0.196 0.138 0.372
1959 0.302 0.200 0.136 0.362
1960 0.301 0.206 0.136 0.357
1961 0.299 0.206 0.137 0.359
1962 0.304 0.204 0.135 0.356
1963 0.298 0.216 0.135 0.352
1964 0.292 0.223 0.135 0.350
1965 0.303 0.215 0.134 0.348
1966 0.314 0.207 0.133 0.347
1967 0.319 0.210 0.132 0.339
1968 0.313 0.219 0.131 0.336
1969 0.323 0.209 0.130 0.338
1970 0.328 0.207 0.130 0.335
1971 0.321 0.213 0.131 0.335
1972 0.326 0.209 0.129 0.337
1973 0.334 0.197 0.128 0.341
1974 0.319 0.214 0.131 0.336
1975 0.324 0.204 0.132 0.339
1976 0.330 0.206 0.131 0.333
1977 0.313 0.218 0.133 0.336
1978 0.320 0.213 0.131 0.336

$quant
       q1    q2    q3   q4
1947   NA    NA    NA   NA
1948 1.53 1.019 0.770 1.97
1949 1.52 1.033 0.748 2.00
1950 1.48 0.994 0.740 2.00
1951 1.46 0.979 0.754 1.97
1952 1.48 1.011 0.748 1.99
1953 1.56 1.056 0.738 1.90
1954 1.51 1.037 0.716 1.87
1955 1.62 1.102 0.708 1.85
1956 1.69 1.147 0.706 1.81
1957 1.63 1.105 0.698 1.86
1958 1.51 1.052 0.701 1.98
1959 1.63 1.106 0.695 1.97
1960 1.68 1.134 0.694 1.95
1961 1.67 1.134 0.690 1.91
1962 1.70 1.144 0.684 1.96
1963 1.73 1.165 0.688 1.95
1964 1.76 1.184 0.699 1.92
1965 1.76 1.176 0.701 1.97
1966 1.78 1.174 0.709 1.99
1967 1.91 1.229 0.707 1.92
1968 1.92 1.241 0.732 1.93
1969 1.92 1.229 0.744 1.94
1970 1.97 1.245 0.746 1.90
1971 1.95 1.245 0.733 1.86
1972 1.91 1.224 0.759 1.98
1973 1.79 1.158 0.769 2.16
1974 1.91 1.233 0.693 2.00
1975 1.92 1.233 0.678 1.95
1976 2.05 1.280 0.723 1.82
1977 2.01 1.271 0.744 1.66
1978 1.96 1.243 0.749 1.80

> print( all.equal( fittedLA, fittedLATX ) )
[1] TRUE
> 
> ####### consistency ###################
> consist <- aidsTestConsist( pNames, wNames, "xFood", Blanciforti86[ set, ],
+    coef = estResultAIDS$coef )
> print( consist )

Tests for theoretical consistency of an estimated Almost Ideal Demand System (AIDS):
Observation where monotonicity is fulfilled: 100 %
Observation where concavity is fulfilled: 0 %
> class( consist ) <- NULL
> print( consist )
$mPercent
[1] 100

$monotony
 [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
[16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
[31] TRUE TRUE

$cPercent
[1] 0

$concavity
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE

$cMatrices
$cMatrices[[1]]
        pFood1  pFood2  pFood3  pFood4
wFood1  0.0648 -0.0637 -0.0135  0.0127
wFood2 -0.0637  0.0197  0.0158  0.0284
wFood3 -0.0135  0.0158 -0.0904  0.0882
wFood4  0.0127  0.0284  0.0882 -0.1289

$cMatrices[[2]]
        pFood1  pFood2  pFood3  pFood4
wFood1  0.0610 -0.0657 -0.0111  0.0159
wFood2 -0.0657  0.0263  0.0152  0.0242
wFood3 -0.0111  0.0152 -0.0934  0.0893
wFood4  0.0159  0.0242  0.0893 -0.1294

$cMatrices[[3]]
        pFood1  pFood2  pFood3  pFood4
wFood1  0.0635 -0.0631 -0.0104  0.0101
wFood2 -0.0631  0.0190  0.0175  0.0266
wFood3 -0.0104  0.0175 -0.0969  0.0898
wFood4  0.0101  0.0266  0.0898 -0.1265

$cMatrices[[4]]
         pFood1  pFood2   pFood3  pFood4
wFood1  0.05600 -0.0619 -0.00808  0.0143
wFood2 -0.06193  0.0223  0.01668  0.0231
wFood3 -0.00808  0.0167 -0.09627  0.0878
wFood4  0.01433  0.0231  0.08781 -0.1249

$cMatrices[[5]]
        pFood1  pFood2  pFood3  pFood4
wFood1  0.0589 -0.0625 -0.0106  0.0138
wFood2 -0.0625  0.0190  0.0167  0.0266
wFood3 -0.0106  0.0167 -0.0935  0.0871
wFood4  0.0138  0.0266  0.0871 -0.1279

$cMatrices[[6]]
        pFood1  pFood2  pFood3  pFood4
wFood1  0.0582 -0.0580 -0.0111  0.0109
wFood2 -0.0580  0.0119  0.0177  0.0284
wFood3 -0.0111  0.0177 -0.0912  0.0846
wFood4  0.0109  0.0284  0.0846 -0.1239

$cMatrices[[7]]
         pFood1  pFood2   pFood3  pFood4
wFood1  0.05237 -0.0591 -0.00986  0.0166
wFood2 -0.05910  0.0137  0.01726  0.0281
wFood3 -0.00986  0.0173 -0.09076  0.0834
wFood4  0.01659  0.0281  0.08336 -0.1281

$cMatrices[[8]]
         pFood1  pFood2   pFood3  pFood4
wFood1  0.04674 -0.0577 -0.00836  0.0196
wFood2 -0.05768  0.0104  0.01810  0.0293
wFood3 -0.00836  0.0181 -0.09102  0.0814
wFood4  0.01962  0.0293  0.08142 -0.1300

$cMatrices[[9]]
        pFood1   pFood2  pFood3  pFood4
wFood1  0.0519 -0.05758 -0.0105  0.0162
wFood2 -0.0576  0.00487  0.0191  0.0336
wFood3 -0.0105  0.01912 -0.0903  0.0817
wFood4  0.0162  0.03359  0.0817 -0.1315

$cMatrices[[10]]
        pFood1   pFood2  pFood3  pFood4
wFood1  0.0545 -0.05855 -0.0118  0.0159
wFood2 -0.0586  0.00180  0.0197  0.0371
wFood3 -0.0118  0.01965 -0.0897  0.0818
wFood4  0.0159  0.03710  0.0818 -0.1348

$cMatrices[[11]]
         pFood1   pFood2   pFood3  pFood4
wFood1  0.05415 -0.05673 -0.00944  0.0120
wFood2 -0.05673  0.00125  0.02111  0.0344
wFood3 -0.00944  0.02111 -0.09465  0.0830
wFood4  0.01202  0.03436  0.08298 -0.1294

$cMatrices[[12]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.05651 -0.05425 -0.0106  0.00833
wFood2 -0.05425  0.00139  0.0203  0.03257
wFood3 -0.01059  0.02030 -0.0921  0.08244
wFood4  0.00833  0.03257  0.0824 -0.12335

$cMatrices[[13]]
        pFood1    pFood2  pFood3  pFood4
wFood1  0.0592 -0.053677 -0.0102  0.0047
wFood2 -0.0537 -0.000964  0.0216  0.0330
wFood3 -0.0102  0.021620 -0.0950  0.0836
wFood4  0.0047  0.033021  0.0836 -0.1213

$cMatrices[[14]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.06241 -0.05381 -0.0126  0.00397
wFood2 -0.05381 -0.00506  0.0218  0.03709
wFood3 -0.01256  0.02178 -0.0921  0.08291
wFood4  0.00397  0.03709  0.0829 -0.12397

$cMatrices[[15]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.06009 -0.05417 -0.0123  0.00637
wFood2 -0.05417 -0.00512  0.0217  0.03764
wFood3 -0.01229  0.02166 -0.0915  0.08217
wFood4  0.00637  0.03764  0.0822 -0.12618

$cMatrices[[16]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.06207 -0.05215 -0.0127  0.00275
wFood2 -0.05215 -0.00676  0.0219  0.03697
wFood3 -0.01267  0.02194 -0.0914  0.08208
wFood4  0.00275  0.03697  0.0821 -0.12179

$cMatrices[[17]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.06138 -0.05314 -0.0125  0.00455
wFood2 -0.05314 -0.00506  0.0216  0.03685
wFood3 -0.01250  0.02156 -0.0914  0.08246
wFood4  0.00455  0.03685  0.0825 -0.12351

$cMatrices[[18]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.06047 -0.05237 -0.0118  0.00367
wFood2 -0.05237 -0.00796  0.0227  0.03759
wFood3 -0.01176  0.02274 -0.0930  0.08197
wFood4  0.00367  0.03759  0.0820 -0.12323

$cMatrices[[19]]
          pFood1   pFood2  pFood3    pFood4
wFood1  0.063793 -0.05130 -0.0125 -0.000031
wFood2 -0.051304 -0.00728  0.0224  0.036155
wFood3 -0.012458  0.02243 -0.0927  0.082712
wFood4 -0.000031  0.03616  0.0827 -0.118836

$cMatrices[[20]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.06068 -0.04918 -0.0136  0.00207
wFood2 -0.04918 -0.00435  0.0199  0.03358
wFood3 -0.01357  0.01995 -0.0866  0.08026
wFood4  0.00207  0.03358  0.0803 -0.11592

$cMatrices[[21]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.06055 -0.05025 -0.0116  0.00159
wFood2 -0.05025 -0.00497  0.0216  0.03380
wFood3 -0.01157  0.02164 -0.0919  0.08198
wFood4  0.00159  0.03380  0.0820 -0.11702

$cMatrices[[22]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.06177 -0.05006 -0.0128  0.00139
wFood2 -0.05006 -0.00494  0.0210  0.03426
wFood3 -0.01279  0.02096 -0.0896  0.08161
wFood4  0.00139  0.03426  0.0816 -0.11691

$cMatrices[[23]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.05960 -0.04837 -0.0137  0.00248
wFood2 -0.04837 -0.00316  0.0192  0.03230
wFood3 -0.01371  0.01923 -0.0851  0.07957
wFood4  0.00248  0.03230  0.0796 -0.11435

$cMatrices[[24]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.05677 -0.04845 -0.0141  0.00547
wFood2 -0.04845 -0.00143  0.0181  0.03161
wFood3 -0.01411  0.01806 -0.0821  0.07808
wFood4  0.00547  0.03161  0.0781 -0.11550

$cMatrices[[25]]
         pFood1   pFood2   pFood3   pFood4
wFood1  0.05272 -0.04597 -0.00916  0.00274
wFood2 -0.04597 -0.00615  0.02174  0.03059
wFood3 -0.00916  0.02174 -0.09125  0.07881
wFood4  0.00274  0.03059  0.07881 -0.11182

$cMatrices[[26]]
         pFood1    pFood2  pFood3   pFood4
wFood1  0.05589 -0.045964 -0.0120  0.00207
wFood2 -0.04596  0.000442  0.0184  0.02717
wFood3 -0.01200  0.018357 -0.0849  0.07856
wFood4  0.00207  0.027166  0.0786 -0.10779

$cMatrices[[27]]
         pFood1    pFood2  pFood3   pFood4
wFood1  0.06163 -0.041340 -0.0142 -0.00611
wFood2 -0.04134 -0.000508  0.0174  0.02442
wFood3 -0.01418  0.017428 -0.0814  0.07811
wFood4 -0.00611  0.024420  0.0781 -0.09642

$cMatrices[[28]]
         pFood1   pFood2  pFood3   pFood4
wFood1  0.05589 -0.04808 -0.0120  0.00418
wFood2 -0.04808  0.00098  0.0185  0.02858
wFood3 -0.01199  0.01852 -0.0858  0.07927
wFood4  0.00418  0.02858  0.0793 -0.11203

$cMatrices[[29]]
         pFood1    pFood2   pFood3   pFood4
wFood1  0.05465 -0.048910 -0.00866  0.00293
wFood2 -0.04891 -0.000282  0.02093  0.02826
wFood3 -0.00866  0.020931 -0.09332  0.08105
wFood4  0.00293  0.028262  0.08105 -0.11224

$cMatrices[[30]]
         pFood1   pFood2   pFood3   pFood4
wFood1  0.04924 -0.04663 -0.00829  0.00535
wFood2 -0.04663 -0.00271  0.02076  0.02836
wFood3 -0.00829  0.02076 -0.09058  0.07798
wFood4  0.00535  0.02836  0.07798 -0.11202

$cMatrices[[31]]
         pFood1   pFood2   pFood3  pFood4
wFood1  0.04353 -0.04840 -0.00722  0.0118
wFood2 -0.04840 -0.00757  0.02244  0.0333
wFood3 -0.00722  0.02244 -0.09192  0.0766
wFood4  0.01176  0.03330  0.07656 -0.1220

$cMatrices[[32]]
         pFood1  pFood2   pFood3   pFood4
wFood1  0.04875 -0.0422 -0.00931  0.00280
wFood2 -0.04224 -0.0118  0.02229  0.03178
wFood3 -0.00931  0.0223 -0.08847  0.07548
wFood4  0.00280  0.0318  0.07548 -0.11006


> 
> 
