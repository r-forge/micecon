
R version 2.4.0 (2006-10-03)
Copyright (C) 2006 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(micEcon)
Loading required package: systemfit
> library(mvtnorm)
> options(digits=6)
> N <- 1500
> NNA <- 5
> vc <- diag(3)
> vc[lower.tri(vc)] <- c(0.9, 0.5, 0.6)
> vc[upper.tri(vc)] <- vc[lower.tri(vc)]
> set.seed(1)
> ## ------- Tobit-5 example ---------
> eps <- rmvnorm(N, rep(0, 3), vc)
> xs <- runif(N)
> ys <- xs + eps[,1] > 0
> xo1 <- runif(N)
> yo1 <- xo1 + eps[,2]
> xo2 <- runif(N)
> yo2 <- xo2 + eps[,3]
> ## Put some NA-s into the data
> ys[sample(N, NNA)] <- NA
> xs[sample(N, NNA)] <- NA
> xo1[sample(N, NNA)] <- NA
> xo2[sample(N, NNA)] <- NA
> yo1[sample(N, NNA)] <- NA
> yo2[sample(N, NNA)] <- NA
> a <- selection(ys~xs, list(yo1 ~ xo1, yo2 ~ xo2), method="2step")
 > print(summary(a))
2-step estimation of switching regression (tobit-5) model
1479 observations (479 selection 1 and 1000 selection 2) and 12 free parameters (df = 1469)
Probit selection equation:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.07977    0.06558   1.216    0.224    
xs           0.78112    0.11766   6.639 4.43e-11 ***
Outcome equation 1:
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   0.6189         NA      NA       NA
xo1           0.9975         NA      NA       NA
Multiple R-Squared:0.218,	Adjusted R-Squared:0.214
Outcome equation 2:
             Estimate Std. Error t value Pr(>|t|)
(Intercept) -0.003428         NA      NA       NA
xo2          0.927595         NA      NA       NA
Multiple R-Squared:0.083,	Adjusted R-Squared:0.081
Error terms:
               Estimate Std. Error t value Pr(>|t|)
invMillsRatio1  -1.5153         NA      NA       NA
invMillsRatio2   0.6186         NA      NA       NA
sigma1           1.2926         NA      NA       NA
sigma2           0.9929         NA      NA       NA
rho1             0.9900         NA      NA       NA
rho2             0.6230         NA      NA       NA
> a <- selection(ys~xs, list(yo1 ~ xo1, yo2 ~ xo2), method="ml")
  > print(summary(a))
--------------------------------------------
Tobit 5 selection model/Maximum Likelihood estimation
Newton-Raphson maximisation, 9 iterations
Return code 2: successive function values within tolerance limit.
 May be a solution
Log-Likelihood: -2774.84 
1479 observations (479 selection 1 and 1000 selection 2) and 10 free parameters (df = 1469)
Probit selection equation:
            Estimate Std. error t value Pr(> t)    
(Intercept) 0.002098   0.057064   0.037    0.97    
xs          0.955862   0.093904  10.179  <2e-16 ***
Outcome equation 1:
            Estimate Std. error t value Pr(> t)    
(Intercept)   0.0712     0.1166   0.611   0.541    
xo1           0.9870     0.1159   8.516  <2e-16 ***
Outcome equation 2:
            Estimate Std. error t value Pr(> t)    
(Intercept)  0.07087    0.11164   0.635   0.526    
xo2          0.93618    0.10162   9.212  <2e-16 ***
Error terms data:
       Estimate Std. error t value Pr(> t)    
sigma1  1.12140    0.06722  16.683 < 2e-16 ***
sigma2  0.99800    0.04797  20.806 < 2e-16 ***
rho1    0.90346    0.02630  34.350 < 2e-16 ***
rho2    0.47218    0.15987   2.953 0.00314 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
--------------------------------------------
> ## ------- Tobit-2 exmple -----------
> vc <- diag(2)
> vc[2,1] <- vc[1,2] <- -0.7
> eps <- rmvnorm(N, rep(0, 2), vc)
> xs <- runif(N)
> ys <- xs + eps[,1] > 0
> xo <- runif(N)
> yo <- (xo + eps[,2])*(ys > 0)
> xs[sample(N, NNA)] <- NA
> ys[sample(N, NNA)] <- NA
> xo[sample(N, NNA)] <- NA
> yo[sample(N, NNA)] <- NA
> a <- selection(ys~xs, yo ~xo, method="2step")
 > print(summary(a))
2-step estimation of heckit (tobit-2) model
1481 observations (461 censored and 1020 observed) and 7 parameters (df = 1475)
Probit selection equation:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.06466    0.06690   0.967    0.334    
xs           0.89105    0.12165   7.325 3.92e-13 ***
Outcome equation:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)   0.1283     0.1310    0.98    0.327    
xo            0.9176     0.0910   10.08   <2e-16 ***
Multiple R-Squared:0.104,	Adjusted R-Squared:0.102
Error terms:
              Estimate Std. Error t value Pr(>|t|)    
invMillsRatio  -0.8714     0.2381   -3.66 0.000261 ***
sigma           1.0458         NA      NA       NA    
rho            -0.8333         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
> a <- selection(ys~xs, yo ~xo, method="ml")
  > print(summary(a))
--------------------------------------------
Tobit 2 selection model/Maximum Likelihood estimation
Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero. May be a solution
Log-Likelihood: -2159.85 
1481 observations (461 censored and 1020 observed) and 6 free parameters (df = 1475)
Probit selection equation:
            Estimate Std. error t value Pr(> t)    
(Intercept)  0.04199    0.06039   0.695   0.487    
xs           0.93125    0.10845   8.587  <2e-16 ***
Outcome equation:
            Estimate Std. error t value Pr(> t)    
(Intercept)  0.06973    0.06166   1.131   0.258    
xo           0.95026    0.08967  10.597  <2e-16 ***
Error terms data:
      Estimate Std. error t value Pr(> t)    
sigma  1.01254    0.03672   27.57  <2e-16 ***
rho   -0.77910    0.04533  -17.19  <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
--------------------------------------------
> 
> 
