
R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library( "micEconNP" )
Loading required package: np
Loading required package: boot
Loading required package: cubature
Nonparametric Kernel Methods for Mixed Datatypes (version 0.50-1)
[vignette("np_faq",package="np") provides answers to frequently asked questions]
Loading required package: crs
Categorical Regression Splines (version 0.15-18)
[vignette("crs_faq") provides answers to frequently asked questions]
Loading required package: micEcon
Loading required package: miscTools
> 
> ## taken from the documentation of crs(), slightly modified
> 
> set.seed(42)
> ## Example - simulated data
> n <- 1000
> num.eval <- 50
> x1 <- runif(n)
> x2 <- runif(n)
> z <- round( runif( n, min = 0, max = 3 ) )
> dgp <- cos( 2 * pi * x1 ) + sin( 2 * pi * x2 ) + z
> z <- factor(z)
> y <- dgp + rnorm( n, sd = 0.5 )
> 
> ## Estimate a model with specified degree and bandwidth
> model <- crs( y ~ x1 + x2 + z, degree = c(5,5), segments= c(1,1), lambda = c(0.1),
+    cv = "none", kernel = TRUE, deriv = 1, basis = "additive" )
Working...          Working...          Working...          > summary( model )
Call:
crs.formula(formula = y ~ x1 + x2 + z, degree = c(5, 5), segments = c(1, 
    1), cv = "none", kernel = TRUE, lambda = c(0.1), basis = "additive", 
    deriv = 1)

Kernel Weighting/B-spline Bases Regression Spline

There are 2 continuous predictors
There is 1 categorical predictor
Spline degree/number of segments for x1: 5/1
Spline degree/number of segments for x2: 5/1
Bandwidth for z: 0.1
Model complexity proxy: degree-knots
Knot type: quantiles
Basis type: additive
Training observations: 1000
Rank of model frame: 11
Trace of smoother matrix: 33

Residual standard error: 0.6126 on 989 degrees of freedom
Multiple R-squared: 0.8478,   Adjusted R-squared: 0.8463
F-statistic: 152.4 on 32 and 967 DF, p-value: 0
Estimation time: 0.3 seconds

> 
> zGrad <- crsGradFactor( model, "z" )
Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          > 
> round( zGrad, 2 )
        z: 0 -> 1 z: 0 -> 2 z: 0 -> 3
   [1,]        NA        NA      1.92
   [2,]      0.69        NA        NA
   [3,]        NA      1.43        NA
   [4,]        NA        NA      1.73
   [5,]        NA        NA      1.67
   [6,]        NA      1.41        NA
   [7,]        NA      1.08        NA
   [8,]        NA        NA      1.97
   [9,]        NA        NA        NA
  [10,]      0.39        NA        NA
  [11,]      0.37        NA        NA
  [12,]        NA        NA        NA
  [13,]        NA      1.24        NA
  [14,]        NA      1.18        NA
  [15,]        NA        NA        NA
  [16,]        NA      1.50        NA
  [17,]      0.74        NA        NA
  [18,]        NA      1.20        NA
  [19,]        NA      1.30        NA
  [20,]        NA        NA      1.60
  [21,]      0.70        NA        NA
  [22,]        NA      1.42        NA
  [23,]      0.70        NA        NA
  [24,]        NA        NA        NA
  [25,]        NA      1.21        NA
  [26,]        NA      1.13        NA
  [27,]      0.46        NA        NA
  [28,]      0.63        NA        NA
  [29,]        NA      1.25        NA
  [30,]        NA        NA      1.87
  [31,]        NA        NA        NA
  [32,]      0.50        NA        NA
  [33,]        NA        NA        NA
  [34,]      0.34        NA        NA
  [35,]        NA        NA        NA
  [36,]        NA        NA        NA
  [37,]        NA      1.68        NA
  [38,]        NA        NA        NA
  [39,]      0.68        NA        NA
  [40,]        NA        NA        NA
  [41,]        NA        NA      1.99
  [42,]        NA        NA        NA
  [43,]      0.55        NA        NA
  [44,]        NA      1.23        NA
  [45,]        NA        NA      1.80
  [46,]        NA      1.22        NA
  [47,]        NA        NA      1.79
  [48,]        NA        NA        NA
  [49,]      1.02        NA        NA
  [50,]      0.23        NA        NA
  [51,]        NA      1.42        NA
  [52,]        NA      1.18        NA
  [53,]      0.44        NA        NA
  [54,]        NA      1.18        NA
  [55,]        NA      1.32        NA
  [56,]        NA      1.31        NA
  [57,]        NA        NA        NA
  [58,]        NA      1.20        NA
  [59,]        NA        NA        NA
  [60,]        NA      1.10        NA
  [61,]        NA      1.29        NA
  [62,]        NA        NA        NA
  [63,]        NA      1.09        NA
  [64,]        NA      1.22        NA
  [65,]        NA      1.27        NA
  [66,]        NA        NA      2.03
  [67,]        NA      1.49        NA
  [68,]      0.51        NA        NA
  [69,]      0.33        NA        NA
  [70,]        NA        NA      2.00
  [71,]      0.63        NA        NA
  [72,]        NA      1.41        NA
  [73,]        NA        NA      1.99
  [74,]        NA      1.34        NA
  [75,]      0.57        NA        NA
  [76,]      0.43        NA        NA
  [77,]        NA        NA        NA
  [78,]        NA        NA      1.82
  [79,]      0.34        NA        NA
  [80,]        NA      1.49        NA
  [81,]        NA        NA        NA
  [82,]      0.78        NA        NA
  [83,]      0.45        NA        NA
  [84,]        NA      1.11        NA
  [85,]        NA        NA        NA
  [86,]      0.26        NA        NA
  [87,]        NA        NA        NA
  [88,]      0.63        NA        NA
  [89,]        NA      1.27        NA
  [90,]        NA        NA        NA
  [91,]        NA      1.30        NA
  [92,]        NA      1.74        NA
  [93,]      0.63        NA        NA
  [94,]      0.73        NA        NA
  [95,]      0.66        NA        NA
  [96,]        NA      1.09        NA
  [97,]      0.54        NA        NA
  [98,]      0.34        NA        NA
  [99,]        NA      1.36        NA
 [100,]      0.35        NA        NA
 [101,]        NA      1.17        NA
 [102,]      0.64        NA        NA
 [103,]        NA      1.21        NA
 [104,]        NA      1.28        NA
 [105,]        NA      1.31        NA
 [106,]      0.78        NA        NA
 [107,]        NA      1.28        NA
 [108,]        NA        NA      1.65
 [109,]        NA      1.21        NA
 [110,]        NA      1.73        NA
 [111,]        NA      1.03        NA
 [112,]        NA        NA      1.68
 [113,]        NA      1.35        NA
 [114,]        NA        NA      1.78
 [115,]        NA        NA      1.65
 [116,]        NA      1.07        NA
 [117,]        NA        NA        NA
 [118,]      0.52        NA        NA
 [119,]        NA        NA      1.64
 [120,]      0.60        NA        NA
 [121,]      0.53        NA        NA
 [122,]      0.49        NA        NA
 [123,]      0.35        NA        NA
 [124,]        NA        NA      1.62
 [125,]        NA      1.29        NA
 [126,]        NA        NA      1.86
 [127,]      0.71        NA        NA
 [128,]      0.76        NA        NA
 [129,]        NA        NA        NA
 [130,]      0.38        NA        NA
 [131,]      0.60        NA        NA
 [132,]        NA        NA        NA
 [133,]        NA      1.09        NA
 [134,]        NA      1.73        NA
 [135,]        NA        NA        NA
 [136,]        NA      1.04        NA
 [137,]        NA      1.20        NA
 [138,]        NA        NA      1.86
 [139,]      0.41        NA        NA
 [140,]        NA        NA        NA
 [141,]        NA        NA      1.86
 [142,]        NA      1.47        NA
 [143,]        NA      1.16        NA
 [144,]      0.51        NA        NA
 [145,]      0.38        NA        NA
 [146,]        NA      1.18        NA
 [147,]        NA      1.52        NA
 [148,]        NA        NA      1.84
 [149,]        NA      1.26        NA
 [150,]      0.60        NA        NA
 [151,]        NA      1.31        NA
 [152,]        NA      1.64        NA
 [153,]      0.64        NA        NA
 [154,]        NA        NA        NA
 [155,]        NA        NA        NA
 [156,]        NA      1.38        NA
 [157,]        NA        NA        NA
 [158,]        NA        NA        NA
 [159,]      0.63        NA        NA
 [160,]        NA        NA      1.55
 [161,]        NA      1.28        NA
 [162,]        NA        NA      1.67
 [163,]      0.28        NA        NA
 [164,]        NA      1.23        NA
 [165,]      0.29        NA        NA
 [166,]      0.57        NA        NA
 [167,]      0.39        NA        NA
 [168,]        NA      1.26        NA
 [169,]        NA      1.22        NA
 [170,]      0.59        NA        NA
 [171,]      0.37        NA        NA
 [172,]        NA        NA        NA
 [173,]      0.46        NA        NA
 [174,]        NA      1.37        NA
 [175,]      0.41        NA        NA
 [176,]        NA        NA        NA
 [177,]        NA        NA        NA
 [178,]      0.50        NA        NA
 [179,]        NA      1.17        NA
 [180,]      0.70        NA        NA
 [181,]        NA        NA        NA
 [182,]        NA        NA      1.64
 [183,]        NA      1.22        NA
 [184,]        NA      1.20        NA
 [185,]      0.45        NA        NA
 [186,]        NA      1.26        NA
 [187,]        NA        NA        NA
 [188,]      0.48        NA        NA
 [189,]        NA      1.23        NA
 [190,]        NA        NA      2.07
 [191,]        NA      1.20        NA
 [192,]      0.52        NA        NA
 [193,]        NA        NA      1.87
 [194,]        NA        NA      1.84
 [195,]        NA      1.49        NA
 [196,]        NA        NA        NA
 [197,]      0.26        NA        NA
 [198,]      0.60        NA        NA
 [199,]        NA        NA      1.78
 [200,]      0.39        NA        NA
 [201,]      0.61        NA        NA
 [202,]        NA      1.12        NA
 [203,]        NA        NA        NA
 [204,]      0.39        NA        NA
 [205,]      0.63        NA        NA
 [206,]        NA      1.41        NA
 [207,]      0.76        NA        NA
 [208,]        NA        NA        NA
 [209,]        NA      1.21        NA
 [210,]      0.62        NA        NA
 [211,]        NA      1.31        NA
 [212,]      0.54        NA        NA
 [213,]      0.48        NA        NA
 [214,]        NA      1.30        NA
 [215,]      0.42        NA        NA
 [216,]      0.59        NA        NA
 [217,]        NA        NA      1.60
 [218,]        NA        NA        NA
 [219,]        NA      1.36        NA
 [220,]        NA      1.51        NA
 [221,]      0.31        NA        NA
 [222,]        NA      1.21        NA
 [223,]        NA      1.06        NA
 [224,]        NA        NA        NA
 [225,]        NA      1.32        NA
 [226,]        NA        NA        NA
 [227,]        NA        NA      1.93
 [228,]      0.60        NA        NA
 [229,]        NA      1.56        NA
 [230,]      0.62        NA        NA
 [231,]        NA        NA        NA
 [232,]        NA        NA      2.02
 [233,]        NA      1.22        NA
 [234,]        NA      1.51        NA
 [235,]      0.77        NA        NA
 [236,]        NA        NA      1.71
 [237,]        NA      1.23        NA
 [238,]        NA      1.27        NA
 [239,]        NA        NA      1.70
 [240,]        NA        NA      1.68
 [241,]        NA        NA        NA
 [242,]        NA        NA        NA
 [243,]        NA        NA      1.75
 [244,]      0.73        NA        NA
 [245,]        NA        NA      1.59
 [246,]      0.39        NA        NA
 [247,]      0.66        NA        NA
 [248,]        NA        NA        NA
 [249,]      0.34        NA        NA
 [250,]        NA      1.39        NA
 [251,]      0.55        NA        NA
 [252,]        NA        NA        NA
 [253,]      0.53        NA        NA
 [254,]        NA      1.22        NA
 [255,]        NA      1.41        NA
 [256,]        NA      1.38        NA
 [257,]      0.66        NA        NA
 [258,]        NA      1.09        NA
 [259,]      0.29        NA        NA
 [260,]        NA      1.29        NA
 [261,]      0.42        NA        NA
 [262,]        NA        NA      1.95
 [263,]      0.58        NA        NA
 [264,]        NA      1.25        NA
 [265,]        NA      1.14        NA
 [266,]        NA      1.19        NA
 [267,]        NA        NA      1.88
 [268,]        NA        NA        NA
 [269,]      0.77        NA        NA
 [270,]        NA      1.30        NA
 [271,]      0.57        NA        NA
 [272,]      0.51        NA        NA
 [273,]        NA      1.11        NA
 [274,]        NA        NA        NA
 [275,]        NA      1.31        NA
 [276,]        NA      1.24        NA
 [277,]        NA      1.18        NA
 [278,]        NA      1.26        NA
 [279,]        NA      1.15        NA
 [280,]        NA      1.24        NA
 [281,]        NA        NA        NA
 [282,]        NA      1.33        NA
 [283,]        NA        NA      1.91
 [284,]        NA      1.21        NA
 [285,]        NA      1.52        NA
 [286,]        NA        NA      2.01
 [287,]        NA      1.21        NA
 [288,]        NA        NA      1.29
 [289,]      0.48        NA        NA
 [290,]        NA      1.35        NA
 [291,]        NA        NA        NA
 [292,]      0.36        NA        NA
 [293,]      0.42        NA        NA
 [294,]      0.51        NA        NA
 [295,]      0.54        NA        NA
 [296,]        NA      1.19        NA
 [297,]        NA        NA      1.70
 [298,]      0.28        NA        NA
 [299,]      0.66        NA        NA
 [300,]      0.55        NA        NA
 [301,]      0.39        NA        NA
 [302,]        NA        NA      1.96
 [303,]        NA        NA      1.62
 [304,]      0.51        NA        NA
 [305,]        NA      1.23        NA
 [306,]        NA      1.55        NA
 [307,]        NA      1.25        NA
 [308,]        NA        NA      2.09
 [309,]        NA        NA      2.03
 [310,]        NA        NA      1.91
 [311,]        NA      1.31        NA
 [312,]        NA        NA      2.06
 [313,]        NA        NA      1.62
 [314,]        NA        NA      1.74
 [315,]        NA      1.25        NA
 [316,]      0.66        NA        NA
 [317,]        NA        NA        NA
 [318,]      0.37        NA        NA
 [319,]        NA        NA        NA
 [320,]        NA        NA      2.08
 [321,]        NA      1.16        NA
 [322,]        NA      1.22        NA
 [323,]        NA        NA        NA
 [324,]        NA      1.48        NA
 [325,]        NA      1.06        NA
 [326,]        NA        NA      1.93
 [327,]        NA        NA      1.90
 [328,]        NA      1.45        NA
 [329,]        NA      1.31        NA
 [330,]        NA        NA      1.66
 [331,]      0.74        NA        NA
 [332,]      0.55        NA        NA
 [333,]        NA        NA        NA
 [334,]      0.53        NA        NA
 [335,]      0.38        NA        NA
 [336,]      0.42        NA        NA
 [337,]      0.31        NA        NA
 [338,]      0.49        NA        NA
 [339,]        NA      1.19        NA
 [340,]      0.57        NA        NA
 [341,]        NA      1.30        NA
 [342,]        NA        NA      1.70
 [343,]        NA      1.20        NA
 [344,]      0.52        NA        NA
 [345,]        NA      1.35        NA
 [346,]        NA      1.57        NA
 [347,]      0.72        NA        NA
 [348,]        NA        NA      1.76
 [349,]        NA      1.27        NA
 [350,]        NA        NA        NA
 [351,]        NA      1.11        NA
 [352,]        NA      1.08        NA
 [353,]        NA      1.25        NA
 [354,]        NA        NA        NA
 [355,]        NA        NA      1.72
 [356,]        NA        NA      1.72
 [357,]        NA        NA        NA
 [358,]        NA      1.30        NA
 [359,]        NA        NA      1.72
 [360,]        NA      1.09        NA
 [361,]        NA      1.07        NA
 [362,]      0.35        NA        NA
 [363,]        NA        NA        NA
 [364,]        NA        NA        NA
 [365,]      0.36        NA        NA
 [366,]      0.30        NA        NA
 [367,]      0.28        NA        NA
 [368,]      0.67        NA        NA
 [369,]      0.50        NA        NA
 [370,]        NA        NA      1.81
 [371,]        NA        NA        NA
 [372,]      0.57        NA        NA
 [373,]      0.39        NA        NA
 [374,]      0.59        NA        NA
 [375,]      0.38        NA        NA
 [376,]      0.70        NA        NA
 [377,]      0.56        NA        NA
 [378,]      0.59        NA        NA
 [379,]        NA        NA        NA
 [380,]        NA        NA        NA
 [381,]        NA      1.01        NA
 [382,]        NA      1.39        NA
 [383,]        NA      1.20        NA
 [384,]        NA      1.19        NA
 [385,]        NA      1.12        NA
 [386,]        NA        NA      1.62
 [387,]        NA      1.18        NA
 [388,]      0.78        NA        NA
 [389,]        NA      1.25        NA
 [390,]        NA      1.25        NA
 [391,]        NA        NA      1.67
 [392,]        NA        NA        NA
 [393,]      0.30        NA        NA
 [394,]        NA      1.22        NA
 [395,]        NA        NA        NA
 [396,]        NA      1.11        NA
 [397,]        NA      1.28        NA
 [398,]        NA        NA      1.94
 [399,]        NA      1.06        NA
 [400,]        NA        NA      1.71
 [401,]      0.63        NA        NA
 [402,]        NA        NA        NA
 [403,]        NA      1.05        NA
 [404,]        NA      1.20        NA
 [405,]        NA      1.22        NA
 [406,]        NA        NA      1.75
 [407,]        NA      1.25        NA
 [408,]      0.62        NA        NA
 [409,]        NA      1.19        NA
 [410,]        NA      1.23        NA
 [411,]        NA      1.20        NA
 [412,]        NA      1.08        NA
 [413,]        NA        NA        NA
 [414,]      0.34        NA        NA
 [415,]        NA        NA      1.85
 [416,]        NA      1.22        NA
 [417,]        NA      1.31        NA
 [418,]        NA        NA      1.67
 [419,]      0.39        NA        NA
 [420,]      0.62        NA        NA
 [421,]        NA        NA        NA
 [422,]        NA      1.14        NA
 [423,]        NA      1.42        NA
 [424,]        NA      1.32        NA
 [425,]        NA      1.09        NA
 [426,]        NA        NA        NA
 [427,]        NA        NA      1.65
 [428,]        NA        NA      1.74
 [429,]      0.38        NA        NA
 [430,]      0.38        NA        NA
 [431,]      0.31        NA        NA
 [432,]        NA        NA      1.84
 [433,]        NA        NA      1.90
 [434,]        NA      1.42        NA
 [435,]        NA        NA        NA
 [436,]      0.63        NA        NA
 [437,]        NA      1.17        NA
 [438,]        NA        NA      2.18
 [439,]        NA      1.20        NA
 [440,]        NA      1.14        NA
 [441,]        NA      1.04        NA
 [442,]        NA        NA      1.74
 [443,]        NA      1.46        NA
 [444,]      0.63        NA        NA
 [445,]      0.51        NA        NA
 [446,]      0.43        NA        NA
 [447,]        NA        NA      1.97
 [448,]      0.54        NA        NA
 [449,]        NA        NA        NA
 [450,]        NA        NA        NA
 [451,]      0.49        NA        NA
 [452,]        NA      1.18        NA
 [453,]      0.40        NA        NA
 [454,]      0.30        NA        NA
 [455,]        NA      1.14        NA
 [456,]        NA        NA        NA
 [457,]        NA      1.21        NA
 [458,]        NA      1.37        NA
 [459,]        NA      1.25        NA
 [460,]        NA      1.21        NA
 [461,]        NA        NA        NA
 [462,]        NA      1.25        NA
 [463,]        NA      1.22        NA
 [464,]      0.59        NA        NA
 [465,]        NA      1.21        NA
 [466,]      0.37        NA        NA
 [467,]        NA        NA      1.79
 [468,]      0.57        NA        NA
 [469,]      0.42        NA        NA
 [470,]        NA      1.27        NA
 [471,]        NA        NA      1.91
 [472,]        NA      1.45        NA
 [473,]      0.67        NA        NA
 [474,]        NA        NA      2.01
 [475,]      0.33        NA        NA
 [476,]        NA        NA        NA
 [477,]        NA      1.26        NA
 [478,]        NA        NA        NA
 [479,]      0.62        NA        NA
 [480,]        NA      1.28        NA
 [481,]        NA      1.17        NA
 [482,]        NA        NA      1.90
 [483,]        NA        NA        NA
 [484,]      0.63        NA        NA
 [485,]      0.65        NA        NA
 [486,]      0.44        NA        NA
 [487,]      0.60        NA        NA
 [488,]        NA      1.43        NA
 [489,]      0.51        NA        NA
 [490,]        NA        NA        NA
 [491,]        NA        NA      2.07
 [492,]        NA      1.08        NA
 [493,]        NA        NA      1.65
 [494,]        NA        NA      1.76
 [495,]        NA        NA      1.68
 [496,]        NA        NA        NA
 [497,]      0.48        NA        NA
 [498,]      0.58        NA        NA
 [499,]        NA      1.22        NA
 [500,]        NA      1.31        NA
 [501,]        NA        NA        NA
 [502,]        NA        NA      2.18
 [503,]      0.28        NA        NA
 [504,]      0.59        NA        NA
 [505,]        NA        NA      1.85
 [506,]        NA      1.32        NA
 [507,]      0.36        NA        NA
 [508,]        NA      1.20        NA
 [509,]        NA        NA        NA
 [510,]        NA        NA      1.95
 [511,]        NA      1.19        NA
 [512,]        NA      1.58        NA
 [513,]        NA        NA      2.01
 [514,]      0.53        NA        NA
 [515,]        NA        NA        NA
 [516,]      0.51        NA        NA
 [517,]      0.64        NA        NA
 [518,]        NA      1.21        NA
 [519,]        NA      1.20        NA
 [520,]      0.45        NA        NA
 [521,]        NA        NA      1.74
 [522,]        NA        NA        NA
 [523,]      0.56        NA        NA
 [524,]      0.66        NA        NA
 [525,]        NA        NA      1.67
 [526,]        NA      1.07        NA
 [527,]      0.62        NA        NA
 [528,]        NA      1.37        NA
 [529,]        NA        NA        NA
 [530,]      0.59        NA        NA
 [531,]        NA        NA        NA
 [532,]        NA        NA        NA
 [533,]      0.44        NA        NA
 [534,]        NA      1.08        NA
 [535,]      0.40        NA        NA
 [536,]        NA      1.36        NA
 [537,]      0.57        NA        NA
 [538,]        NA        NA      1.57
 [539,]        NA        NA      1.71
 [540,]        NA        NA        NA
 [541,]        NA      1.31        NA
 [542,]        NA        NA        NA
 [543,]      0.33        NA        NA
 [544,]        NA      1.21        NA
 [545,]      0.31        NA        NA
 [546,]        NA        NA        NA
 [547,]        NA        NA        NA
 [548,]        NA        NA      2.02
 [549,]        NA        NA        NA
 [550,]        NA        NA      1.92
 [551,]        NA      1.32        NA
 [552,]        NA      1.47        NA
 [553,]        NA      1.04        NA
 [554,]      0.61        NA        NA
 [555,]        NA        NA      1.88
 [556,]        NA      1.31        NA
 [557,]        NA      1.25        NA
 [558,]        NA      1.26        NA
 [559,]        NA      1.29        NA
 [560,]        NA      1.13        NA
 [561,]        NA      1.19        NA
 [562,]      0.87        NA        NA
 [563,]      0.63        NA        NA
 [564,]      0.57        NA        NA
 [565,]        NA      1.22        NA
 [566,]        NA      1.31        NA
 [567,]        NA      1.08        NA
 [568,]        NA      1.27        NA
 [569,]      0.37        NA        NA
 [570,]      0.41        NA        NA
 [571,]      0.28        NA        NA
 [572,]      0.74        NA        NA
 [573,]        NA        NA      1.98
 [574,]        NA      1.46        NA
 [575,]        NA        NA        NA
 [576,]      0.37        NA        NA
 [577,]        NA        NA      1.22
 [578,]        NA        NA        NA
 [579,]      0.49        NA        NA
 [580,]        NA        NA        NA
 [581,]        NA        NA      1.99
 [582,]        NA      1.25        NA
 [583,]      0.38        NA        NA
 [584,]        NA      1.00        NA
 [585,]      0.62        NA        NA
 [586,]        NA      1.15        NA
 [587,]        NA      1.22        NA
 [588,]        NA        NA      1.96
 [589,]      0.42        NA        NA
 [590,]        NA        NA      1.68
 [591,]        NA      1.19        NA
 [592,]        NA      1.32        NA
 [593,]      0.33        NA        NA
 [594,]        NA        NA        NA
 [595,]        NA        NA      1.60
 [596,]      0.39        NA        NA
 [597,]        NA      1.07        NA
 [598,]        NA        NA        NA
 [599,]        NA      1.25        NA
 [600,]        NA        NA      1.75
 [601,]        NA        NA        NA
 [602,]      0.61        NA        NA
 [603,]      0.49        NA        NA
 [604,]        NA        NA        NA
 [605,]        NA        NA      1.71
 [606,]      0.42        NA        NA
 [607,]        NA      1.16        NA
 [608,]      0.85        NA        NA
 [609,]      0.40        NA        NA
 [610,]        NA      1.08        NA
 [611,]      0.34        NA        NA
 [612,]      0.31        NA        NA
 [613,]        NA      1.07        NA
 [614,]        NA        NA      2.07
 [615,]      0.60        NA        NA
 [616,]        NA      1.43        NA
 [617,]        NA      1.48        NA
 [618,]        NA        NA        NA
 [619,]        NA        NA        NA
 [620,]        NA        NA        NA
 [621,]        NA        NA      1.61
 [622,]      0.45        NA        NA
 [623,]        NA      1.43        NA
 [624,]      0.39        NA        NA
 [625,]        NA      1.43        NA
 [626,]      0.39        NA        NA
 [627,]        NA        NA        NA
 [628,]        NA      1.18        NA
 [629,]      0.30        NA        NA
 [630,]      0.34        NA        NA
 [631,]      0.49        NA        NA
 [632,]        NA        NA        NA
 [633,]        NA        NA        NA
 [634,]        NA        NA      2.08
 [635,]        NA      1.20        NA
 [636,]        NA        NA      1.74
 [637,]        NA        NA      1.76
 [638,]        NA        NA      1.58
 [639,]      0.86        NA        NA
 [640,]        NA      1.34        NA
 [641,]      0.43        NA        NA
 [642,]      0.65        NA        NA
 [643,]        NA        NA      1.65
 [644,]        NA      1.53        NA
 [645,]        NA        NA        NA
 [646,]        NA        NA        NA
 [647,]        NA      1.09        NA
 [648,]        NA      1.48        NA
 [649,]      0.70        NA        NA
 [650,]        NA        NA        NA
 [651,]      0.63        NA        NA
 [652,]        NA        NA        NA
 [653,]      0.60        NA        NA
 [654,]        NA        NA      1.90
 [655,]        NA        NA      1.77
 [656,]        NA        NA      1.75
 [657,]        NA        NA        NA
 [658,]        NA      1.25        NA
 [659,]        NA      1.14        NA
 [660,]        NA        NA      2.12
 [661,]        NA        NA      1.69
 [662,]        NA        NA        NA
 [663,]        NA        NA        NA
 [664,]        NA      1.23        NA
 [665,]        NA        NA        NA
 [666,]      0.41        NA        NA
 [667,]        NA      1.21        NA
 [668,]        NA        NA        NA
 [669,]      0.49        NA        NA
 [670,]      0.60        NA        NA
 [671,]      0.37        NA        NA
 [672,]      0.45        NA        NA
 [673,]      0.65        NA        NA
 [674,]        NA        NA        NA
 [675,]      0.57        NA        NA
 [676,]        NA      1.17        NA
 [677,]        NA      1.43        NA
 [678,]        NA      1.69        NA
 [679,]      0.53        NA        NA
 [680,]        NA        NA      1.99
 [681,]        NA      1.24        NA
 [682,]        NA        NA      1.85
 [683,]        NA      1.09        NA
 [684,]        NA      1.25        NA
 [685,]        NA        NA        NA
 [686,]        NA      1.23        NA
 [687,]      0.57        NA        NA
 [688,]        NA        NA        NA
 [689,]        NA      1.08        NA
 [690,]        NA        NA      1.73
 [691,]      0.31        NA        NA
 [692,]        NA        NA        NA
 [693,]        NA        NA        NA
 [694,]      0.61        NA        NA
 [695,]      0.58        NA        NA
 [696,]        NA        NA        NA
 [697,]        NA      1.31        NA
 [698,]      0.66        NA        NA
 [699,]      0.71        NA        NA
 [700,]        NA        NA      1.65
 [701,]      0.43        NA        NA
 [702,]        NA      1.12        NA
 [703,]      0.64        NA        NA
 [704,]      0.37        NA        NA
 [705,]        NA      1.16        NA
 [706,]        NA      1.06        NA
 [707,]      0.60        NA        NA
 [708,]      0.53        NA        NA
 [709,]        NA      1.24        NA
 [710,]        NA      1.22        NA
 [711,]        NA      1.30        NA
 [712,]      0.65        NA        NA
 [713,]        NA        NA        NA
 [714,]        NA        NA        NA
 [715,]      0.47        NA        NA
 [716,]        NA        NA      1.59
 [717,]      0.50        NA        NA
 [718,]      0.50        NA        NA
 [719,]        NA      1.29        NA
 [720,]      0.36        NA        NA
 [721,]        NA        NA        NA
 [722,]        NA        NA        NA
 [723,]        NA        NA      1.97
 [724,]        NA        NA      1.71
 [725,]        NA        NA      1.92
 [726,]        NA        NA        NA
 [727,]      0.52        NA        NA
 [728,]        NA      1.35        NA
 [729,]      0.42        NA        NA
 [730,]        NA        NA      1.60
 [731,]      0.44        NA        NA
 [732,]        NA        NA      1.96
 [733,]      0.80        NA        NA
 [734,]        NA        NA      1.82
 [735,]      0.62        NA        NA
 [736,]        NA        NA      1.64
 [737,]        NA      1.22        NA
 [738,]        NA      1.28        NA
 [739,]        NA        NA        NA
 [740,]      0.58        NA        NA
 [741,]        NA      1.27        NA
 [742,]        NA        NA        NA
 [743,]        NA      1.07        NA
 [744,]        NA      1.24        NA
 [745,]        NA        NA        NA
 [746,]        NA      1.29        NA
 [747,]        NA      1.32        NA
 [748,]        NA        NA        NA
 [749,]        NA      1.28        NA
 [750,]        NA      1.19        NA
 [751,]      0.57        NA        NA
 [752,]      0.64        NA        NA
 [753,]      0.43        NA        NA
 [754,]        NA      1.19        NA
 [755,]        NA      1.46        NA
 [756,]        NA      1.19        NA
 [757,]        NA      1.28        NA
 [758,]      0.57        NA        NA
 [759,]      0.71        NA        NA
 [760,]        NA        NA        NA
 [761,]        NA        NA      1.95
 [762,]        NA      1.04        NA
 [763,]      0.75        NA        NA
 [764,]        NA        NA        NA
 [765,]      0.53        NA        NA
 [766,]      0.44        NA        NA
 [767,]        NA      1.26        NA
 [768,]        NA      1.21        NA
 [769,]        NA        NA      1.68
 [770,]        NA        NA      1.80
 [771,]      0.70        NA        NA
 [772,]        NA      1.21        NA
 [773,]        NA        NA        NA
 [774,]      0.65        NA        NA
 [775,]      0.43        NA        NA
 [776,]        NA      1.38        NA
 [777,]        NA        NA        NA
 [778,]        NA      1.29        NA
 [779,]        NA        NA        NA
 [780,]        NA      1.29        NA
 [781,]        NA      1.07        NA
 [782,]      0.31        NA        NA
 [783,]      0.55        NA        NA
 [784,]        NA        NA        NA
 [785,]        NA      1.09        NA
 [786,]        NA      1.24        NA
 [787,]      0.60        NA        NA
 [788,]      0.36        NA        NA
 [789,]        NA      1.15        NA
 [790,]        NA        NA        NA
 [791,]      0.64        NA        NA
 [792,]        NA      1.31        NA
 [793,]      0.38        NA        NA
 [794,]      0.62        NA        NA
 [795,]        NA      1.07        NA
 [796,]      0.49        NA        NA
 [797,]        NA      1.45        NA
 [798,]        NA        NA        NA
 [799,]        NA        NA        NA
 [800,]      0.59        NA        NA
 [801,]        NA      1.50        NA
 [802,]        NA      1.31        NA
 [803,]        NA        NA        NA
 [804,]        NA      1.25        NA
 [805,]      0.37        NA        NA
 [806,]      0.66        NA        NA
 [807,]      0.30        NA        NA
 [808,]        NA        NA        NA
 [809,]      0.78        NA        NA
 [810,]        NA        NA        NA
 [811,]        NA        NA      2.10
 [812,]        NA      1.32        NA
 [813,]        NA        NA        NA
 [814,]        NA        NA      1.68
 [815,]      0.44        NA        NA
 [816,]        NA        NA        NA
 [817,]        NA        NA      1.88
 [818,]        NA        NA      1.70
 [819,]        NA        NA        NA
 [820,]        NA        NA      1.82
 [821,]      0.63        NA        NA
 [822,]        NA      1.24        NA
 [823,]      0.51        NA        NA
 [824,]        NA      1.33        NA
 [825,]        NA      1.57        NA
 [826,]        NA        NA      1.91
 [827,]      0.64        NA        NA
 [828,]      0.55        NA        NA
 [829,]      0.62        NA        NA
 [830,]      0.62        NA        NA
 [831,]        NA        NA      1.86
 [832,]      0.47        NA        NA
 [833,]      0.58        NA        NA
 [834,]      0.45        NA        NA
 [835,]        NA      1.04        NA
 [836,]        NA      1.07        NA
 [837,]        NA      1.22        NA
 [838,]        NA        NA      1.70
 [839,]        NA      1.27        NA
 [840,]        NA      1.67        NA
 [841,]        NA      1.40        NA
 [842,]        NA        NA        NA
 [843,]        NA      1.25        NA
 [844,]        NA      1.21        NA
 [845,]      0.30        NA        NA
 [846,]        NA        NA      1.96
 [847,]      0.61        NA        NA
 [848,]        NA        NA        NA
 [849,]      0.55        NA        NA
 [850,]        NA        NA      2.08
 [851,]        NA      1.30        NA
 [852,]        NA      1.14        NA
 [853,]      0.54        NA        NA
 [854,]        NA      1.28        NA
 [855,]      0.31        NA        NA
 [856,]      0.62        NA        NA
 [857,]        NA        NA        NA
 [858,]        NA      1.55        NA
 [859,]      0.44        NA        NA
 [860,]        NA      1.28        NA
 [861,]        NA        NA        NA
 [862,]        NA      1.31        NA
 [863,]      0.57        NA        NA
 [864,]        NA        NA      2.00
 [865,]        NA      1.30        NA
 [866,]        NA      1.39        NA
 [867,]        NA      1.27        NA
 [868,]      0.65        NA        NA
 [869,]        NA      1.11        NA
 [870,]        NA        NA      2.00
 [871,]        NA      1.48        NA
 [872,]        NA      1.29        NA
 [873,]        NA      1.43        NA
 [874,]      0.57        NA        NA
 [875,]        NA        NA      1.88
 [876,]        NA        NA        NA
 [877,]        NA        NA      1.78
 [878,]        NA      1.08        NA
 [879,]        NA        NA        NA
 [880,]        NA        NA        NA
 [881,]        NA      1.40        NA
 [882,]        NA        NA        NA
 [883,]        NA      1.01        NA
 [884,]      0.47        NA        NA
 [885,]        NA      1.55        NA
 [886,]        NA        NA        NA
 [887,]      0.62        NA        NA
 [888,]      0.56        NA        NA
 [889,]        NA        NA      1.62
 [890,]      0.53        NA        NA
 [891,]        NA        NA        NA
 [892,]        NA        NA        NA
 [893,]        NA      1.42        NA
 [894,]      0.44        NA        NA
 [895,]        NA      1.23        NA
 [896,]        NA      1.31        NA
 [897,]      0.49        NA        NA
 [898,]        NA      1.21        NA
 [899,]        NA      1.10        NA
 [900,]        NA      1.35        NA
 [901,]        NA      1.49        NA
 [902,]      0.61        NA        NA
 [903,]      0.61        NA        NA
 [904,]        NA      1.42        NA
 [905,]        NA        NA      1.57
 [906,]        NA        NA      2.06
 [907,]      0.50        NA        NA
 [908,]        NA        NA        NA
 [909,]        NA      1.03        NA
 [910,]      0.84        NA        NA
 [911,]      0.52        NA        NA
 [912,]        NA      1.21        NA
 [913,]        NA        NA        NA
 [914,]        NA      1.32        NA
 [915,]      0.48        NA        NA
 [916,]        NA        NA      1.57
 [917,]        NA        NA        NA
 [918,]        NA        NA      1.82
 [919,]        NA      1.46        NA
 [920,]      0.63        NA        NA
 [921,]        NA        NA        NA
 [922,]        NA      1.46        NA
 [923,]        NA        NA        NA
 [924,]      0.58        NA        NA
 [925,]        NA      0.99        NA
 [926,]      0.63        NA        NA
 [927,]        NA        NA        NA
 [928,]        NA        NA      2.01
 [929,]      0.66        NA        NA
 [930,]      0.39        NA        NA
 [931,]      0.50        NA        NA
 [932,]        NA      1.23        NA
 [933,]        NA        NA      1.99
 [934,]        NA      1.29        NA
 [935,]      0.39        NA        NA
 [936,]        NA        NA        NA
 [937,]      0.56        NA        NA
 [938,]      0.56        NA        NA
 [939,]      0.66        NA        NA
 [940,]        NA      1.15        NA
 [941,]        NA      1.07        NA
 [942,]      0.31        NA        NA
 [943,]      0.57        NA        NA
 [944,]      0.50        NA        NA
 [945,]      0.47        NA        NA
 [946,]      0.45        NA        NA
 [947,]      0.73        NA        NA
 [948,]        NA        NA        NA
 [949,]        NA        NA      1.88
 [950,]        NA        NA        NA
 [951,]        NA        NA      1.89
 [952,]        NA      1.25        NA
 [953,]      0.57        NA        NA
 [954,]        NA        NA        NA
 [955,]        NA      1.25        NA
 [956,]      0.28        NA        NA
 [957,]      0.33        NA        NA
 [958,]        NA      1.29        NA
 [959,]        NA        NA      1.80
 [960,]        NA        NA        NA
 [961,]        NA      1.32        NA
 [962,]        NA      1.05        NA
 [963,]        NA        NA        NA
 [964,]      0.57        NA        NA
 [965,]      0.62        NA        NA
 [966,]        NA      1.38        NA
 [967,]        NA        NA        NA
 [968,]        NA        NA        NA
 [969,]      0.42        NA        NA
 [970,]      0.56        NA        NA
 [971,]        NA      1.45        NA
 [972,]        NA        NA      1.64
 [973,]      0.36        NA        NA
 [974,]        NA      1.01        NA
 [975,]        NA        NA        NA
 [976,]      0.62        NA        NA
 [977,]        NA        NA      2.00
 [978,]        NA      1.20        NA
 [979,]      0.40        NA        NA
 [980,]        NA        NA      1.94
 [981,]        NA      1.31        NA
 [982,]      0.58        NA        NA
 [983,]        NA      1.14        NA
 [984,]        NA        NA      1.60
 [985,]        NA      1.16        NA
 [986,]        NA      1.21        NA
 [987,]        NA        NA      1.88
 [988,]      0.65        NA        NA
 [989,]        NA        NA      2.06
 [990,]        NA        NA      1.81
 [991,]        NA        NA      1.72
 [992,]        NA        NA        NA
 [993,]        NA      1.15        NA
 [994,]      0.62        NA        NA
 [995,]        NA      1.41        NA
 [996,]        NA        NA      1.85
 [997,]      0.32        NA        NA
 [998,]        NA      1.25        NA
 [999,]        NA        NA        NA
[1000,]        NA      1.66        NA
> 
> all.equal( rowSums( zGrad, na.rm = TRUE )[ z != 0 ], 
+    model$deriv.mat[ z != 0 , 3 ] )
[1] TRUE
> 
> 
> ## Estimate a model with data-driven degree, segments, and bandwidth
> model2 <- crs( y ~ x1 + x2 + z, deriv = 1, basis = "additive", nmulti = 1 )
Calling NOMAD (Nonsmooth Optimization by Mesh Adaptive Direct Search)

starting point # 0: (  1  1  1  1 0.9148060435 )

                                                fv = 1.913277                                                 fv = 1.438377                                                 fv = 1.426146                                                 fv = 1.435598                                                 fv = 1.430714                                                 fv = 1.766929                                                 fv = 1.075241                                                 fv = 0.4444665                                                 fv = 0.2676701                                                 fv = 1.142127                                                 fv = 0.3617117                                                 fv = 0.3101109                                                 fv = 1.15568                                                 fv = 1.211261                                                 fv = 0.8699081                                                 fv = 1.212817                                                 fv = 1.673279                                                 fv = 0.8144406                                                 fv = 0.8135497                                                 fv = 0.7435193                                                 fv = 0.3031261                                                 fv = 0.8691542                                                 fv = 1.216392                                                 fv = 0.28109                                                 fv = 0.8580604                                                 fv = 0.2674593                                                 fv = 0.8144406                                                 fv = 0.7480645                                                 fv = 1.874647                                                 fv = 1.470686                                                 fv = 1.328152                                                 fv = 0.3652626                                                 fv = 1.046406                                                 fv = 1.503437                                                 fv = 1.472903                                                 fv = 1.481041                                                 fv = 0.7379989                                                 fv = 0.2672601                                                 fv = 0.7457428                                                 fv = 0.8144406                                                 fv = 0.2705546                                                 fv = 1.773535                                                 fv = 0.8123278                                                 fv = 0.3063683                                                 fv = 1.218928                                                 fv = 0.267741                                                 fv = 0.292487                                                 fv = 0.7469877                                                 fv = 1.377027                                                 fv = 1.124075                                                 fv = 0.8186308                                                 fv = 1.016743                                                 fv = 1.126379                                                 fv = 0.8613681                                                 fv = 0.2850879                                                 fv = 1.214324                                                 fv = 0.2636348                                                 fv = 0.7338883                                                 fv = 1.225614                                                 fv = 1.398576                                                 fv = 0.8718985                                                 fv = 0.7982366                                                 fv = 1.589624                                                 fv = 0.4137806                                                 fv = 0.2983052                                                 fv = 1.776064                                                 fv = 0.7508571                                                 fv = 0.2714535                                                 fv = 0.8716199                                                 fv = 0.4995161                                                 fv = 1.214653                                                 fv = 0.5050124                                                 fv = 0.8659125                                                 fv = 0.2676273                                                 fv = 0.2826406                                                 fv = 1.110948                                                 fv = 0.5969334                                                 fv = 0.2683166                                                 fv = 0.5759615                                                 fv = 0.5966404                                                 fv = 1.08696                                                 fv = 1.017559                                                 fv = 0.27056                                                 fv = 0.2675242                                                 fv = 0.8143912                                                 fv = 0.5878919                                                 fv = 0.2673458                                                 fv = 0.2614822                                                 fv = 0.2948615                                                 fv = 0.2596561                                                 fv = 1.328152                                                 fv = 0.7528292                                                 fv = 1.328152                                                 fv = 1.966612                                                 fv = 0.2667642                                                 fv = 1.586672                                                 fv = 0.8239674                                                 fv = 0.8468059                                                 fv = 1.379349                                                 fv = 0.2639441                                                 fv = 1.134354                                                 fv = 0.2675001                                                 fv = 0.7971026                                                 fv = 0.789525                                                 fv = 0.5919659                                                 fv = 1.374656                                                 fv = 0.2720481                                                 fv = 0.9297513                                                 fv = 0.5008957                                                 fv = 0.5899496                                                 fv = 0.2596841                                                 fv = 0.2636863                                                 fv = 0.6080683                                                 fv = 0.2942085                                                 fv = 0.4897659                                                 fv = 0.2627485                                                 fv = 0.2612548                                                 fv = 0.8324582                                                 fv = 0.2650833                                                 fv = 0.4960588                                                 fv = 0.2614676                                                 fv = 0.4119147                                                 fv = 0.2947078                                                 fv = 0.2630953                                                 fv = 0.2654585                                                 fv = 0.2614052                                                 fv = 0.5760693                                                 fv = 0.2633199                                                 fv = 0.2615109                                                 fv = 0.4110736                                                 fv = 0.2602255                                                 fv = 0.2617176                                                 fv = 0.2602764                                                 fv = 0.297078                                                 fv = 0.2604495                                                 fv = 0.4000732                                                 fv = 0.2615613                                                 fv = 0.2603118                                                 fv = 0.3101746                                                 fv = 0.2635066                                                 fv = 0.3035739                                                 fv = 0.2609112                                                 fv = 0.296972                                                 fv = 0.2630323                                                 fv = 0.2675034                                                 fv = 0.2622978                                                 fv = 0.261489                                                 fv = 0.2646617                                                 fv = 0.259718                                                 fv = 0.2610473                                                 fv = 0.2625563                                                 fv = 0.2632079                                                 fv = 0.2638694                                                 fv = 0.2623596                                                 fv = 0.261645                                                 fv = 0.2998473                                                 fv = 0.2602321                                                 fv = 0.2591916                                                 fv = 0.801232                                                 fv = 0.259585                                                 fv = 0.2627899                                                 fv = 0.2592062                                                 fv = 0.2646881                                                 fv = 0.2965036                                                 fv = 0.261243                                                 fv = 0.3008645                                                 fv = 0.2592398                                                 fv = 0.2591251                                                 fv = 0.7896992                                                 fv = 0.2612716                                                 fv = 0.2598151                                                 fv = 0.2974466                                                 fv = 0.2603128                                                 fv = 0.2632889                                                 fv = 0.2945806                                                 fv = 0.2758507                                                 fv = 0.2591733                                                 fv = 0.2588858                                                 fv = 0.8012264                                                 fv = 0.2913917                                                 fv = 0.262685                                                 fv = 0.2588371                                                 fv = 0.2624689                                                 fv = 0.2605263                                                 fv = 0.2910565                                                 fv = 0.2612972                                                 fv = 0.262161                                                 fv = 0.2965968                                                 fv = 0.2605938                                                 fv = 0.2589422                                                 fv = 0.4035053                                                 fv = 0.2588981                                                 fv = 0.3124611                                                 fv = 0.2638329                                                 fv = 0.2656884                                                 fv = 0.2588849                                                 fv = 0.2606681                                                 fv = 0.2638558                                                 fv = 0.2602154                                                 fv = 0.2589368                                                 fv = 0.2589495                                                 fv = 0.2632136                                                 fv = 0.2916677                                                 fv = 0.2630449                                                 fv = 0.2993226                                                 fv = 0.2602351                                                 fv = 0.2660024                                                 fv = 0.2627594                                                 fv = 0.2589932                                                 fv = 0.2590035                                                 fv = 0.2605391                                                 fv = 0.259655                                                 fv = 0.2634254                                                 fv = 0.2637879                                                 fv = 0.2616691                                                 fv = 0.2660064                                                 fv = 0.2607415                                                 fv = 0.2658498                                                 fv = 0.2589239                                                 fv = 0.2963179                                                 fv = 0.2639798                                                 fv = 0.2659363                                                 fv = 0.2588396                                                 fv = 0.2933715                                                 fv = 0.2618858                                                 fv = 0.2590851                                                 fv = 0.258835                                                 fv = 0.2588543                                                 fv = 0.2588381                                                 fv = 0.2991981                                                 fv = 0.2657865                                                 fv = 0.3013753                                                 fv = 0.2697167                                                 fv = 0.2615818                                                 fv = 0.2630584                                                 fv = 0.2638835                                                 fv = 0.2616029                                                 fv = 0.2664219                                                 fv = 0.2627456                                                 fv = 0.260528                                                 fv = 0.2588877                                                 fv = 0.2605928                                                 fv = 0.2588848                                                 fv = 0.2612954                                                 fv = 0.2965979                                                 fv = 0.2910535                                                 fv = 0.2621599                                                 fv = 0.2589387                                                 fv = 0.258889                                                 fv = 0.258835                                                 fv = 0.2605382                                                 fv = 0.2932462                                                 fv = 0.2638882                                                 fv = 0.2659377                                                 fv = 0.261918                                                 fv = 0.2588403                                                 fv = 0.2605937                                                 fv = 0.2589395                                                 fv = 0.2588942                                                 fv = 0.2963874                                                 fv = 0.2605252                                                 fv = 0.2588374                                                 fv = 0.2659351                                                 fv = 0.2912597                                                 fv = 0.2631387                                                 fv = 0.2588823                                                 fv = 0.2992247                                                 fv = 0.2626604                                                 fv = 0.2965969                                                 fv = 0.2621637                                                 fv = 0.2588352                                                 fv = 0.2605257                                                 fv = 0.2606692                                                 fv = 0.2657312                                                 fv = 0.2678214                                                 fv = 0.2592022                                                 fv = 0.2633277                                                 fv = 0.2637734                                                 fv = 0.2615979                                                 fv = 0.2658595                                                 fv = 0.2588829                                                 fv = 0.258835                                                 fv = 0.2605259                                                 fv = 0.2623031                                                 fv = 0.2588207                                                 fv = 0.2623922                                                 fv = 0.2603944                                                 fv = 0.2629557                                                 fv = 0.2990348                                                 fv = 0.2952454                                                 fv = 0.2638704                                                 fv = 0.2632679                                                 fv = 0.26266                                                 fv = 0.2618828                                                 fv = 0.2589414                                                 fv = 0.2910532                                                 fv = 0.2603934                                                 fv = 0.2603936                                                 fv = 0.2910688                                                 fv = 0.2621479                                                 fv = 0.2624492                                                 fv = 0.2966483                                                 fv = 0.2612815                                                 fv = 0.25894                                                 fv = 0.2589391                                                 fv = 0.2603933                                                 fv = 0.2588209                                                 fv = 0.2910687                                                 fv = 0.2621479                                                 fv = 0.2966482                                                 fv = 0.2612815                                                 fv = 0.2588207                                                 fv = 0.2588207                                                 fv = 0.2588206                                                 fv = 0.2588208                                                 fv = 0.2912602                                                 fv = 0.2952483                                                 fv = 0.2629563                                                 fv = 0.2612956                                                 fv = 0.2621481                                                 fv = 0.2966485                                                 fv = 0.2910539                                                 fv = 0.2649584                                                 fv = 0.2932129                                                 fv = 0.2618839                                                 fv = 0.2588206                                                 fv = 0.258821                                                 fv = 0.2659508                                                 fv = 0.2932128                                                 fv = 0.2631574                                                 fv = 0.2605253                                                 fv = 0.2637708                                                 fv = 0.2618829                                                 fv = 0.2588267                                                 fv = 0.258821                                                 fv = 0.2588207                                                 fv = 0.2605256                                                 fv = 0.2612815                                                 fv = 0.2966487                                                 fv = 0.258939                                                 fv = 0.2603934                                                 fv = 0.262148                                                 fv = 0.2910684                                                 fv = 0.2605252                                                 fv = 0.2588207 run # 0: f=0.2588206448

bb eval : 345
best    : 0.2588206448
worst   : 0.2588206448
solution: x = ( 2 6 3 1 0.00132818222 ) f(x) = 0.2588206448

                                                                      Working...          Working...          Working...          > summary( model2 )
Call:
crs.formula(formula = y ~ x1 + x2 + z, basis = "additive", deriv = 1, 
    nmulti = 1)

Kernel Weighting/B-spline Bases Regression Spline

There are 2 continuous predictors
There is 1 categorical predictor
Spline degree/number of segments for x1: 2/3
Spline degree/number of segments for x2: 6/1
Bandwidth for z: 0.001328182
Model complexity proxy: degree-knots
Knot type: quantiles
Basis type: additive
Training observations: 1000
Rank of model frame: 11
Trace of smoother matrix: 44

Residual standard error: 0.4891 on 989 degrees of freedom
Multiple R-squared: 0.8945,   Adjusted R-squared: 0.8934
F-statistic: 188.5 on 43 and 956 DF, p-value: 0

Cross-validation score: 0.25882064
Number of multistarts: 1
Estimation time: 6.0 seconds

> 
> zGrad2 <- crsGradFactor( model2, "z" )
Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          Working...          > 
> round( zGrad2, 2 )
        z: 0 -> 1 z: 0 -> 2 z: 0 -> 3
   [1,]        NA        NA      3.14
   [2,]      1.02        NA        NA
   [3,]        NA      2.23        NA
   [4,]        NA        NA      2.73
   [5,]        NA        NA      2.72
   [6,]        NA      2.26        NA
   [7,]        NA      1.62        NA
   [8,]        NA        NA      3.18
   [9,]        NA        NA        NA
  [10,]      0.92        NA        NA
  [11,]      0.82        NA        NA
  [12,]        NA        NA        NA
  [13,]        NA      2.03        NA
  [14,]        NA      2.06        NA
  [15,]        NA        NA        NA
  [16,]        NA      2.26        NA
  [17,]      1.24        NA        NA
  [18,]        NA      2.05        NA
  [19,]        NA      2.20        NA
  [20,]        NA        NA      3.11
  [21,]      1.06        NA        NA
  [22,]        NA      2.14        NA
  [23,]      1.31        NA        NA
  [24,]        NA        NA        NA
  [25,]        NA      1.97        NA
  [26,]        NA      1.97        NA
  [27,]      0.82        NA        NA
  [28,]      0.93        NA        NA
  [29,]        NA      2.08        NA
  [30,]        NA        NA      3.01
  [31,]        NA        NA        NA
  [32,]      1.05        NA        NA
  [33,]        NA        NA        NA
  [34,]      0.93        NA        NA
  [35,]        NA        NA        NA
  [36,]        NA        NA        NA
  [37,]        NA      2.14        NA
  [38,]        NA        NA        NA
  [39,]      0.90        NA        NA
  [40,]        NA        NA        NA
  [41,]        NA        NA      3.22
  [42,]        NA        NA        NA
  [43,]      0.91        NA        NA
  [44,]        NA      1.93        NA
  [45,]        NA        NA      3.20
  [46,]        NA      2.12        NA
  [47,]        NA        NA      2.82
  [48,]        NA        NA        NA
  [49,]      1.87        NA        NA
  [50,]      0.76        NA        NA
  [51,]        NA      2.24        NA
  [52,]        NA      2.09        NA
  [53,]      0.99        NA        NA
  [54,]        NA      1.79        NA
  [55,]        NA      2.03        NA
  [56,]        NA      2.06        NA
  [57,]        NA        NA        NA
  [58,]        NA      1.77        NA
  [59,]        NA        NA        NA
  [60,]        NA      2.07        NA
  [61,]        NA      2.05        NA
  [62,]        NA        NA        NA
  [63,]        NA      1.85        NA
  [64,]        NA      2.07        NA
  [65,]        NA      1.87        NA
  [66,]        NA        NA      3.21
  [67,]        NA      2.26        NA
  [68,]      1.12        NA        NA
  [69,]      0.78        NA        NA
  [70,]        NA        NA      3.07
  [71,]      0.82        NA        NA
  [72,]        NA      2.13        NA
  [73,]        NA        NA      2.97
  [74,]        NA      2.18        NA
  [75,]      1.25        NA        NA
  [76,]      0.91        NA        NA
  [77,]        NA        NA        NA
  [78,]        NA        NA      2.91
  [79,]      0.98        NA        NA
  [80,]        NA      1.95        NA
  [81,]        NA        NA        NA
  [82,]      1.31        NA        NA
  [83,]      0.99        NA        NA
  [84,]        NA      1.93        NA
  [85,]        NA        NA        NA
  [86,]      0.76        NA        NA
  [87,]        NA        NA        NA
  [88,]      0.84        NA        NA
  [89,]        NA      1.93        NA
  [90,]        NA        NA        NA
  [91,]        NA      2.10        NA
  [92,]        NA      2.14        NA
  [93,]      1.17        NA        NA
  [94,]      0.97        NA        NA
  [95,]      1.28        NA        NA
  [96,]        NA      1.64        NA
  [97,]      0.87        NA        NA
  [98,]      0.84        NA        NA
  [99,]        NA      2.06        NA
 [100,]      0.74        NA        NA
 [101,]        NA      1.99        NA
 [102,]      1.12        NA        NA
 [103,]        NA      1.84        NA
 [104,]        NA      2.07        NA
 [105,]        NA      1.90        NA
 [106,]      1.21        NA        NA
 [107,]        NA      2.04        NA
 [108,]        NA        NA      2.87
 [109,]        NA      2.12        NA
 [110,]        NA      2.20        NA
 [111,]        NA      1.76        NA
 [112,]        NA        NA      2.97
 [113,]        NA      2.04        NA
 [114,]        NA        NA      3.21
 [115,]        NA        NA      2.72
 [116,]        NA      1.99        NA
 [117,]        NA        NA        NA
 [118,]      1.10        NA        NA
 [119,]        NA        NA      2.70
 [120,]      0.92        NA        NA
 [121,]      1.11        NA        NA
 [122,]      0.95        NA        NA
 [123,]      0.73        NA        NA
 [124,]        NA        NA      3.02
 [125,]        NA      2.07        NA
 [126,]        NA        NA      3.27
 [127,]      0.94        NA        NA
 [128,]      1.31        NA        NA
 [129,]        NA        NA        NA
 [130,]      0.69        NA        NA
 [131,]      0.94        NA        NA
 [132,]        NA        NA        NA
 [133,]        NA      1.90        NA
 [134,]        NA      2.43        NA
 [135,]        NA        NA        NA
 [136,]        NA      1.76        NA
 [137,]        NA      1.93        NA
 [138,]        NA        NA      2.77
 [139,]      0.83        NA        NA
 [140,]        NA        NA        NA
 [141,]        NA        NA      3.20
 [142,]        NA      2.14        NA
 [143,]        NA      1.89        NA
 [144,]      0.97        NA        NA
 [145,]      1.00        NA        NA
 [146,]        NA      1.94        NA
 [147,]        NA      2.24        NA
 [148,]        NA        NA      3.13
 [149,]        NA      1.93        NA
 [150,]      1.04        NA        NA
 [151,]        NA      2.09        NA
 [152,]        NA      2.40        NA
 [153,]      1.14        NA        NA
 [154,]        NA        NA        NA
 [155,]        NA        NA        NA
 [156,]        NA      2.04        NA
 [157,]        NA        NA        NA
 [158,]        NA        NA        NA
 [159,]      1.08        NA        NA
 [160,]        NA        NA      2.83
 [161,]        NA      1.81        NA
 [162,]        NA        NA      2.86
 [163,]      0.92        NA        NA
 [164,]        NA      1.85        NA
 [165,]      0.76        NA        NA
 [166,]      1.24        NA        NA
 [167,]      0.92        NA        NA
 [168,]        NA      2.01        NA
 [169,]        NA      1.86        NA
 [170,]      0.94        NA        NA
 [171,]      0.75        NA        NA
 [172,]        NA        NA        NA
 [173,]      0.98        NA        NA
 [174,]        NA      2.27        NA
 [175,]      0.90        NA        NA
 [176,]        NA        NA        NA
 [177,]        NA        NA        NA
 [178,]      1.17        NA        NA
 [179,]        NA      1.65        NA
 [180,]      1.44        NA        NA
 [181,]        NA        NA        NA
 [182,]        NA        NA      2.74
 [183,]        NA      1.81        NA
 [184,]        NA      2.08        NA
 [185,]      0.97        NA        NA
 [186,]        NA      2.00        NA
 [187,]        NA        NA        NA
 [188,]      0.73        NA        NA
 [189,]        NA      1.91        NA
 [190,]        NA        NA      3.24
 [191,]        NA      1.78        NA
 [192,]      0.97        NA        NA
 [193,]        NA        NA      3.12
 [194,]        NA        NA      2.76
 [195,]        NA      2.15        NA
 [196,]        NA        NA        NA
 [197,]      0.79        NA        NA
 [198,]      1.02        NA        NA
 [199,]        NA        NA      3.05
 [200,]      0.70        NA        NA
 [201,]      0.94        NA        NA
 [202,]        NA      1.88        NA
 [203,]        NA        NA        NA
 [204,]      1.11        NA        NA
 [205,]      1.08        NA        NA
 [206,]        NA      2.25        NA
 [207,]      1.30        NA        NA
 [208,]        NA        NA        NA
 [209,]        NA      2.08        NA
 [210,]      1.11        NA        NA
 [211,]        NA      2.17        NA
 [212,]      1.23        NA        NA
 [213,]      0.89        NA        NA
 [214,]        NA      1.92        NA
 [215,]      1.02        NA        NA
 [216,]      0.81        NA        NA
 [217,]        NA        NA      3.09
 [218,]        NA        NA        NA
 [219,]        NA      2.21        NA
 [220,]        NA      2.19        NA
 [221,]      0.79        NA        NA
 [222,]        NA      1.87        NA
 [223,]        NA      1.79        NA
 [224,]        NA        NA        NA
 [225,]        NA      2.08        NA
 [226,]        NA        NA        NA
 [227,]        NA        NA      3.04
 [228,]      1.13        NA        NA
 [229,]        NA      2.21        NA
 [230,]      0.96        NA        NA
 [231,]        NA        NA        NA
 [232,]        NA        NA      3.04
 [233,]        NA      2.10        NA
 [234,]        NA      2.05        NA
 [235,]      1.34        NA        NA
 [236,]        NA        NA      2.71
 [237,]        NA      1.82        NA
 [238,]        NA      1.73        NA
 [239,]        NA        NA      2.82
 [240,]        NA        NA      2.80
 [241,]        NA        NA        NA
 [242,]        NA        NA        NA
 [243,]        NA        NA      3.09
 [244,]      1.19        NA        NA
 [245,]        NA        NA      3.12
 [246,]      0.97        NA        NA
 [247,]      1.08        NA        NA
 [248,]        NA        NA        NA
 [249,]      1.08        NA        NA
 [250,]        NA      2.12        NA
 [251,]      1.14        NA        NA
 [252,]        NA        NA        NA
 [253,]      1.11        NA        NA
 [254,]        NA      2.07        NA
 [255,]        NA      1.87        NA
 [256,]        NA      2.00        NA
 [257,]      1.02        NA        NA
 [258,]        NA      2.04        NA
 [259,]      0.81        NA        NA
 [260,]        NA      2.14        NA
 [261,]      0.91        NA        NA
 [262,]        NA        NA      3.15
 [263,]      1.14        NA        NA
 [264,]        NA      2.11        NA
 [265,]        NA      1.92        NA
 [266,]        NA      1.77        NA
 [267,]        NA        NA      3.06
 [268,]        NA        NA        NA
 [269,]      1.11        NA        NA
 [270,]        NA      1.94        NA
 [271,]      1.21        NA        NA
 [272,]      0.99        NA        NA
 [273,]        NA      2.09        NA
 [274,]        NA        NA        NA
 [275,]        NA      1.90        NA
 [276,]        NA      1.95        NA
 [277,]        NA      2.07        NA
 [278,]        NA      2.07        NA
 [279,]        NA      2.05        NA
 [280,]        NA      2.03        NA
 [281,]        NA        NA        NA
 [282,]        NA      1.94        NA
 [283,]        NA        NA      3.27
 [284,]        NA      2.20        NA
 [285,]        NA      2.26        NA
 [286,]        NA        NA      3.10
 [287,]        NA      2.09        NA
 [288,]        NA        NA      2.67
 [289,]      0.89        NA        NA
 [290,]        NA      1.74        NA
 [291,]        NA        NA        NA
 [292,]      1.01        NA        NA
 [293,]      0.98        NA        NA
 [294,]      1.08        NA        NA
 [295,]      1.11        NA        NA
 [296,]        NA      1.98        NA
 [297,]        NA        NA      2.78
 [298,]      0.87        NA        NA
 [299,]      1.11        NA        NA
 [300,]      0.91        NA        NA
 [301,]      1.01        NA        NA
 [302,]        NA        NA      3.44
 [303,]        NA        NA      2.68
 [304,]      0.94        NA        NA
 [305,]        NA      1.93        NA
 [306,]        NA      2.25        NA
 [307,]        NA      2.03        NA
 [308,]        NA        NA      3.20
 [309,]        NA        NA      3.22
 [310,]        NA        NA      2.96
 [311,]        NA      2.03        NA
 [312,]        NA        NA      3.21
 [313,]        NA        NA      3.16
 [314,]        NA        NA      3.06
 [315,]        NA      1.95        NA
 [316,]      1.18        NA        NA
 [317,]        NA        NA        NA
 [318,]      0.75        NA        NA
 [319,]        NA        NA        NA
 [320,]        NA        NA      2.89
 [321,]        NA      2.10        NA
 [322,]        NA      1.90        NA
 [323,]        NA        NA        NA
 [324,]        NA      2.23        NA
 [325,]        NA      1.76        NA
 [326,]        NA        NA      3.21
 [327,]        NA        NA      3.30
 [328,]        NA      2.12        NA
 [329,]        NA      2.03        NA
 [330,]        NA        NA      2.80
 [331,]      1.05        NA        NA
 [332,]      1.06        NA        NA
 [333,]        NA        NA        NA
 [334,]      0.99        NA        NA
 [335,]      0.75        NA        NA
 [336,]      0.96        NA        NA
 [337,]      0.79        NA        NA
 [338,]      1.22        NA        NA
 [339,]        NA      1.66        NA
 [340,]      0.88        NA        NA
 [341,]        NA      2.14        NA
 [342,]        NA        NA      3.09
 [343,]        NA      1.80        NA
 [344,]      0.87        NA        NA
 [345,]        NA      1.84        NA
 [346,]        NA      2.21        NA
 [347,]      1.18        NA        NA
 [348,]        NA        NA      3.21
 [349,]        NA      1.92        NA
 [350,]        NA        NA        NA
 [351,]        NA      2.07        NA
 [352,]        NA      1.89        NA
 [353,]        NA      1.97        NA
 [354,]        NA        NA        NA
 [355,]        NA        NA      3.04
 [356,]        NA        NA      2.84
 [357,]        NA        NA        NA
 [358,]        NA      1.95        NA
 [359,]        NA        NA      2.88
 [360,]        NA      2.07        NA
 [361,]        NA      1.77        NA
 [362,]      0.90        NA        NA
 [363,]        NA        NA        NA
 [364,]        NA        NA        NA
 [365,]      0.83        NA        NA
 [366,]      0.74        NA        NA
 [367,]      1.02        NA        NA
 [368,]      0.99        NA        NA
 [369,]      0.96        NA        NA
 [370,]        NA        NA      3.03
 [371,]        NA        NA        NA
 [372,]      1.10        NA        NA
 [373,]      1.01        NA        NA
 [374,]      0.89        NA        NA
 [375,]      0.67        NA        NA
 [376,]      1.40        NA        NA
 [377,]      1.06        NA        NA
 [378,]      0.91        NA        NA
 [379,]        NA        NA        NA
 [380,]        NA        NA        NA
 [381,]        NA      2.01        NA
 [382,]        NA      2.27        NA
 [383,]        NA      2.03        NA
 [384,]        NA      2.07        NA
 [385,]        NA      1.98        NA
 [386,]        NA        NA      3.07
 [387,]        NA      2.03        NA
 [388,]      1.11        NA        NA
 [389,]        NA      2.01        NA
 [390,]        NA      1.80        NA
 [391,]        NA        NA      3.08
 [392,]        NA        NA        NA
 [393,]      1.03        NA        NA
 [394,]        NA      1.79        NA
 [395,]        NA        NA        NA
 [396,]        NA      1.80        NA
 [397,]        NA      2.03        NA
 [398,]        NA        NA      3.32
 [399,]        NA      1.77        NA
 [400,]        NA        NA      2.76
 [401,]      0.87        NA        NA
 [402,]        NA        NA        NA
 [403,]        NA      1.79        NA
 [404,]        NA      2.07        NA
 [405,]        NA      1.95        NA
 [406,]        NA        NA      3.06
 [407,]        NA      2.09        NA
 [408,]      1.12        NA        NA
 [409,]        NA      1.99        NA
 [410,]        NA      1.96        NA
 [411,]        NA      2.05        NA
 [412,]        NA      1.96        NA
 [413,]        NA        NA        NA
 [414,]      0.98        NA        NA
 [415,]        NA        NA      2.88
 [416,]        NA      1.83        NA
 [417,]        NA      2.06        NA
 [418,]        NA        NA      2.68
 [419,]      0.89        NA        NA
 [420,]      0.99        NA        NA
 [421,]        NA        NA        NA
 [422,]        NA      1.86        NA
 [423,]        NA      2.25        NA
 [424,]        NA      1.99        NA
 [425,]        NA      1.81        NA
 [426,]        NA        NA        NA
 [427,]        NA        NA      3.17
 [428,]        NA        NA      3.11
 [429,]      0.95        NA        NA
 [430,]      0.90        NA        NA
 [431,]      1.00        NA        NA
 [432,]        NA        NA      3.06
 [433,]        NA        NA      3.12
 [434,]        NA      2.16        NA
 [435,]        NA        NA        NA
 [436,]      0.96        NA        NA
 [437,]        NA      2.10        NA
 [438,]        NA        NA      3.33
 [439,]        NA      1.97        NA
 [440,]        NA      2.05        NA
 [441,]        NA      1.74        NA
 [442,]        NA        NA      3.13
 [443,]        NA      2.24        NA
 [444,]      0.90        NA        NA
 [445,]      1.04        NA        NA
 [446,]      0.88        NA        NA
 [447,]        NA        NA      2.94
 [448,]      0.89        NA        NA
 [449,]        NA        NA        NA
 [450,]        NA        NA        NA
 [451,]      0.96        NA        NA
 [452,]        NA      1.82        NA
 [453,]      0.96        NA        NA
 [454,]      0.78        NA        NA
 [455,]        NA      2.04        NA
 [456,]        NA        NA        NA
 [457,]        NA      2.08        NA
 [458,]        NA      2.14        NA
 [459,]        NA      2.02        NA
 [460,]        NA      1.96        NA
 [461,]        NA        NA        NA
 [462,]        NA      1.86        NA
 [463,]        NA      1.67        NA
 [464,]      0.99        NA        NA
 [465,]        NA      1.84        NA
 [466,]      0.83        NA        NA
 [467,]        NA        NA      3.28
 [468,]      1.25        NA        NA
 [469,]      0.99        NA        NA
 [470,]        NA      1.95        NA
 [471,]        NA        NA      3.31
 [472,]        NA      2.02        NA
 [473,]      0.92        NA        NA
 [474,]        NA        NA      3.20
 [475,]      1.10        NA        NA
 [476,]        NA        NA        NA
 [477,]        NA      2.17        NA
 [478,]        NA        NA        NA
 [479,]      0.89        NA        NA
 [480,]        NA      1.97        NA
 [481,]        NA      2.04        NA
 [482,]        NA        NA      3.43
 [483,]        NA        NA        NA
 [484,]      0.87        NA        NA
 [485,]      1.08        NA        NA
 [486,]      0.82        NA        NA
 [487,]      0.91        NA        NA
 [488,]        NA      2.16        NA
 [489,]      0.89        NA        NA
 [490,]        NA        NA        NA
 [491,]        NA        NA      3.24
 [492,]        NA      2.06        NA
 [493,]        NA        NA      3.07
 [494,]        NA        NA      2.92
 [495,]        NA        NA      2.98
 [496,]        NA        NA        NA
 [497,]      0.82        NA        NA
 [498,]      1.15        NA        NA
 [499,]        NA      2.02        NA
 [500,]        NA      1.97        NA
 [501,]        NA        NA        NA
 [502,]        NA        NA      3.27
 [503,]      0.78        NA        NA
 [504,]      0.91        NA        NA
 [505,]        NA        NA      3.03
 [506,]        NA      1.91        NA
 [507,]      0.76        NA        NA
 [508,]        NA      2.05        NA
 [509,]        NA        NA        NA
 [510,]        NA        NA      3.07
 [511,]        NA      1.81        NA
 [512,]        NA      2.26        NA
 [513,]        NA        NA      3.17
 [514,]      1.05        NA        NA
 [515,]        NA        NA        NA
 [516,]      0.99        NA        NA
 [517,]      0.93        NA        NA
 [518,]        NA      2.09        NA
 [519,]        NA      1.82        NA
 [520,]      1.00        NA        NA
 [521,]        NA        NA      3.06
 [522,]        NA        NA        NA
 [523,]      0.77        NA        NA
 [524,]      1.08        NA        NA
 [525,]        NA        NA      2.75
 [526,]        NA      1.92        NA
 [527,]      0.78        NA        NA
 [528,]        NA      2.04        NA
 [529,]        NA        NA        NA
 [530,]      1.13        NA        NA
 [531,]        NA        NA        NA
 [532,]        NA        NA        NA
 [533,]      0.99        NA        NA
 [534,]        NA      1.87        NA
 [535,]      1.13        NA        NA
 [536,]        NA      2.06        NA
 [537,]      1.02        NA        NA
 [538,]        NA        NA      2.94
 [539,]        NA        NA      2.92
 [540,]        NA        NA        NA
 [541,]        NA      2.03        NA
 [542,]        NA        NA        NA
 [543,]      1.04        NA        NA
 [544,]        NA      2.06        NA
 [545,]      0.76        NA        NA
 [546,]        NA        NA        NA
 [547,]        NA        NA        NA
 [548,]        NA        NA      3.17
 [549,]        NA        NA        NA
 [550,]        NA        NA      3.18
 [551,]        NA      1.93        NA
 [552,]        NA      2.24        NA
 [553,]        NA      1.65        NA
 [554,]      0.87        NA        NA
 [555,]        NA        NA      2.94
 [556,]        NA      2.03        NA
 [557,]        NA      2.00        NA
 [558,]        NA      1.93        NA
 [559,]        NA      1.78        NA
 [560,]        NA      1.63        NA
 [561,]        NA      1.76        NA
 [562,]      1.69        NA        NA
 [563,]      1.06        NA        NA
 [564,]      1.10        NA        NA
 [565,]        NA      2.02        NA
 [566,]        NA      2.10        NA
 [567,]        NA      1.84        NA
 [568,]        NA      2.02        NA
 [569,]      1.02        NA        NA
 [570,]      0.77        NA        NA
 [571,]      1.01        NA        NA
 [572,]      1.22        NA        NA
 [573,]        NA        NA      3.24
 [574,]        NA      1.95        NA
 [575,]        NA        NA        NA
 [576,]      0.91        NA        NA
 [577,]        NA        NA      2.73
 [578,]        NA        NA        NA
 [579,]      1.12        NA        NA
 [580,]        NA        NA        NA
 [581,]        NA        NA      3.04
 [582,]        NA      2.04        NA
 [583,]      0.72        NA        NA
 [584,]        NA      1.91        NA
 [585,]      1.12        NA        NA
 [586,]        NA      2.04        NA
 [587,]        NA      1.96        NA
 [588,]        NA        NA      3.11
 [589,]      0.78        NA        NA
 [590,]        NA        NA      2.70
 [591,]        NA      2.04        NA
 [592,]        NA      1.96        NA
 [593,]      0.86        NA        NA
 [594,]        NA        NA        NA
 [595,]        NA        NA      2.68
 [596,]      0.77        NA        NA
 [597,]        NA      1.77        NA
 [598,]        NA        NA        NA
 [599,]        NA      1.98        NA
 [600,]        NA        NA      2.85
 [601,]        NA        NA        NA
 [602,]      1.09        NA        NA
 [603,]      0.99        NA        NA
 [604,]        NA        NA        NA
 [605,]        NA        NA      2.85
 [606,]      1.03        NA        NA
 [607,]        NA      1.74        NA
 [608,]      1.57        NA        NA
 [609,]      0.88        NA        NA
 [610,]        NA      1.78        NA
 [611,]      0.89        NA        NA
 [612,]      0.84        NA        NA
 [613,]        NA      1.90        NA
 [614,]        NA        NA      3.63
 [615,]      1.07        NA        NA
 [616,]        NA      2.14        NA
 [617,]        NA      2.21        NA
 [618,]        NA        NA        NA
 [619,]        NA        NA        NA
 [620,]        NA        NA        NA
 [621,]        NA        NA      2.84
 [622,]      0.99        NA        NA
 [623,]        NA      2.16        NA
 [624,]      0.79        NA        NA
 [625,]        NA      2.22        NA
 [626,]      0.96        NA        NA
 [627,]        NA        NA        NA
 [628,]        NA      2.08        NA
 [629,]      0.74        NA        NA
 [630,]      1.00        NA        NA
 [631,]      1.16        NA        NA
 [632,]        NA        NA        NA
 [633,]        NA        NA        NA
 [634,]        NA        NA      3.38
 [635,]        NA      2.11        NA
 [636,]        NA        NA      3.10
 [637,]        NA        NA      2.77
 [638,]        NA        NA      3.02
 [639,]      1.62        NA        NA
 [640,]        NA      2.09        NA
 [641,]      0.96        NA        NA
 [642,]      1.13        NA        NA
 [643,]        NA        NA      2.90
 [644,]        NA      2.13        NA
 [645,]        NA        NA        NA
 [646,]        NA        NA        NA
 [647,]        NA      2.08        NA
 [648,]        NA      2.26        NA
 [649,]      1.17        NA        NA
 [650,]        NA        NA        NA
 [651,]      1.18        NA        NA
 [652,]        NA        NA        NA
 [653,]      1.18        NA        NA
 [654,]        NA        NA      3.46
 [655,]        NA        NA      3.06
 [656,]        NA        NA      3.15
 [657,]        NA        NA        NA
 [658,]        NA      1.91        NA
 [659,]        NA      1.82        NA
 [660,]        NA        NA      3.58
 [661,]        NA        NA      2.71
 [662,]        NA        NA        NA
 [663,]        NA        NA        NA
 [664,]        NA      1.81        NA
 [665,]        NA        NA        NA
 [666,]      0.74        NA        NA
 [667,]        NA      2.12        NA
 [668,]        NA        NA        NA
 [669,]      0.82        NA        NA
 [670,]      1.02        NA        NA
 [671,]      0.98        NA        NA
 [672,]      1.04        NA        NA
 [673,]      0.98        NA        NA
 [674,]        NA        NA        NA
 [675,]      0.99        NA        NA
 [676,]        NA      2.05        NA
 [677,]        NA      2.22        NA
 [678,]        NA      2.44        NA
 [679,]      1.16        NA        NA
 [680,]        NA        NA      3.20
 [681,]        NA      2.13        NA
 [682,]        NA        NA      3.14
 [683,]        NA      1.91        NA
 [684,]        NA      2.06        NA
 [685,]        NA        NA        NA
 [686,]        NA      1.77        NA
 [687,]      1.02        NA        NA
 [688,]        NA        NA        NA
 [689,]        NA      1.63        NA
 [690,]        NA        NA      3.15
 [691,]      0.86        NA        NA
 [692,]        NA        NA        NA
 [693,]        NA        NA        NA
 [694,]      0.93        NA        NA
 [695,]      0.93        NA        NA
 [696,]        NA        NA        NA
 [697,]        NA      2.23        NA
 [698,]      1.03        NA        NA
 [699,]      1.20        NA        NA
 [700,]        NA        NA      3.18
 [701,]      0.97        NA        NA
 [702,]        NA      2.01        NA
 [703,]      1.17        NA        NA
 [704,]      0.69        NA        NA
 [705,]        NA      1.77        NA
 [706,]        NA      1.68        NA
 [707,]      1.12        NA        NA
 [708,]      0.97        NA        NA
 [709,]        NA      1.92        NA
 [710,]        NA      2.14        NA
 [711,]        NA      1.90        NA
 [712,]      1.10        NA        NA
 [713,]        NA        NA        NA
 [714,]        NA        NA        NA
 [715,]      0.78        NA        NA
 [716,]        NA        NA      2.63
 [717,]      0.97        NA        NA
 [718,]      1.18        NA        NA
 [719,]        NA      2.01        NA
 [720,]      0.91        NA        NA
 [721,]        NA        NA        NA
 [722,]        NA        NA        NA
 [723,]        NA        NA      3.02
 [724,]        NA        NA      3.20
 [725,]        NA        NA      3.04
 [726,]        NA        NA        NA
 [727,]      0.90        NA        NA
 [728,]        NA      2.23        NA
 [729,]      0.78        NA        NA
 [730,]        NA        NA      2.66
 [731,]      0.81        NA        NA
 [732,]        NA        NA      2.92
 [733,]      1.21        NA        NA
 [734,]        NA        NA      2.80
 [735,]      1.05        NA        NA
 [736,]        NA        NA      2.74
 [737,]        NA      2.10        NA
 [738,]        NA      2.11        NA
 [739,]        NA        NA        NA
 [740,]      0.91        NA        NA
 [741,]        NA      1.83        NA
 [742,]        NA        NA        NA
 [743,]        NA      2.06        NA
 [744,]        NA      2.08        NA
 [745,]        NA        NA        NA
 [746,]        NA      2.09        NA
 [747,]        NA      1.83        NA
 [748,]        NA        NA        NA
 [749,]        NA      1.78        NA
 [750,]        NA      2.11        NA
 [751,]      1.20        NA        NA
 [752,]      1.11        NA        NA
 [753,]      1.16        NA        NA
 [754,]        NA      1.79        NA
 [755,]        NA      2.21        NA
 [756,]        NA      2.07        NA
 [757,]        NA      2.20        NA
 [758,]      1.14        NA        NA
 [759,]      1.37        NA        NA
 [760,]        NA        NA        NA
 [761,]        NA        NA      3.09
 [762,]        NA      1.92        NA
 [763,]      1.20        NA        NA
 [764,]        NA        NA        NA
 [765,]      1.12        NA        NA
 [766,]      0.87        NA        NA
 [767,]        NA      2.05        NA
 [768,]        NA      2.02        NA
 [769,]        NA        NA      2.79
 [770,]        NA        NA      3.10
 [771,]      1.55        NA        NA
 [772,]        NA      1.76        NA
 [773,]        NA        NA        NA
 [774,]      1.16        NA        NA
 [775,]      0.74        NA        NA
 [776,]        NA      1.98        NA
 [777,]        NA        NA        NA
 [778,]        NA      1.76        NA
 [779,]        NA        NA        NA
 [780,]        NA      1.90        NA
 [781,]        NA      1.81        NA
 [782,]      0.76        NA        NA
 [783,]      1.01        NA        NA
 [784,]        NA        NA        NA
 [785,]        NA      1.77        NA
 [786,]        NA      1.91        NA
 [787,]      1.13        NA        NA
 [788,]      0.78        NA        NA
 [789,]        NA      2.05        NA
 [790,]        NA        NA        NA
 [791,]      0.87        NA        NA
 [792,]        NA      2.14        NA
 [793,]      0.82        NA        NA
 [794,]      1.02        NA        NA
 [795,]        NA      1.82        NA
 [796,]      0.93        NA        NA
 [797,]        NA      2.27        NA
 [798,]        NA        NA        NA
 [799,]        NA        NA        NA
 [800,]      0.93        NA        NA
 [801,]        NA      2.19        NA
 [802,]        NA      1.95        NA
 [803,]        NA        NA        NA
 [804,]        NA      2.11        NA
 [805,]      0.75        NA        NA
 [806,]      1.04        NA        NA
 [807,]      0.96        NA        NA
 [808,]        NA        NA        NA
 [809,]      1.49        NA        NA
 [810,]        NA        NA        NA
 [811,]        NA        NA      3.42
 [812,]        NA      1.97        NA
 [813,]        NA        NA        NA
 [814,]        NA        NA      2.75
 [815,]      0.71        NA        NA
 [816,]        NA        NA        NA
 [817,]        NA        NA      2.86
 [818,]        NA        NA      2.66
 [819,]        NA        NA        NA
 [820,]        NA        NA      3.07
 [821,]      0.97        NA        NA
 [822,]        NA      2.12        NA
 [823,]      0.88        NA        NA
 [824,]        NA      1.98        NA
 [825,]        NA      2.20        NA
 [826,]        NA        NA      2.78
 [827,]      1.16        NA        NA
 [828,]      0.76        NA        NA
 [829,]      1.06        NA        NA
 [830,]      1.01        NA        NA
 [831,]        NA        NA      3.10
 [832,]      1.04        NA        NA
 [833,]      0.74        NA        NA
 [834,]      1.18        NA        NA
 [835,]        NA      1.75        NA
 [836,]        NA      1.87        NA
 [837,]        NA      1.83        NA
 [838,]        NA        NA      2.95
 [839,]        NA      2.09        NA
 [840,]        NA      2.10        NA
 [841,]        NA      2.05        NA
 [842,]        NA        NA        NA
 [843,]        NA      2.04        NA
 [844,]        NA      2.07        NA
 [845,]      0.77        NA        NA
 [846,]        NA        NA      2.92
 [847,]      1.09        NA        NA
 [848,]        NA        NA        NA
 [849,]      1.03        NA        NA
 [850,]        NA        NA      3.26
 [851,]        NA      2.22        NA
 [852,]        NA      1.67        NA
 [853,]      1.19        NA        NA
 [854,]        NA      2.09        NA
 [855,]      0.76        NA        NA
 [856,]      1.04        NA        NA
 [857,]        NA        NA        NA
 [858,]        NA      2.26        NA
 [859,]      1.04        NA        NA
 [860,]        NA      1.86        NA
 [861,]        NA        NA        NA
 [862,]        NA      2.11        NA
 [863,]      1.11        NA        NA
 [864,]        NA        NA      2.94
 [865,]        NA      2.06        NA
 [866,]        NA      2.04        NA
 [867,]        NA      2.03        NA
 [868,]      1.16        NA        NA
 [869,]        NA      1.80        NA
 [870,]        NA        NA      3.22
 [871,]        NA      2.08        NA
 [872,]        NA      1.84        NA
 [873,]        NA      1.91        NA
 [874,]      0.82        NA        NA
 [875,]        NA        NA      3.24
 [876,]        NA        NA        NA
 [877,]        NA        NA      3.03
 [878,]        NA      2.05        NA
 [879,]        NA        NA        NA
 [880,]        NA        NA        NA
 [881,]        NA      2.04        NA
 [882,]        NA        NA        NA
 [883,]        NA      1.92        NA
 [884,]      0.84        NA        NA
 [885,]        NA      2.24        NA
 [886,]        NA        NA        NA
 [887,]      0.89        NA        NA
 [888,]      1.16        NA        NA
 [889,]        NA        NA      2.68
 [890,]      0.93        NA        NA
 [891,]        NA        NA        NA
 [892,]        NA        NA        NA
 [893,]        NA      2.24        NA
 [894,]      1.17        NA        NA
 [895,]        NA      1.96        NA
 [896,]        NA      2.00        NA
 [897,]      0.98        NA        NA
 [898,]        NA      2.00        NA
 [899,]        NA      1.83        NA
 [900,]        NA      2.08        NA
 [901,]        NA      2.21        NA
 [902,]      0.96        NA        NA
 [903,]      1.18        NA        NA
 [904,]        NA      1.78        NA
 [905,]        NA        NA      2.75
 [906,]        NA        NA      3.12
 [907,]      1.05        NA        NA
 [908,]        NA        NA        NA
 [909,]        NA      2.03        NA
 [910,]      1.50        NA        NA
 [911,]      1.09        NA        NA
 [912,]        NA      2.10        NA
 [913,]        NA        NA        NA
 [914,]        NA      1.94        NA
 [915,]      0.85        NA        NA
 [916,]        NA        NA      2.74
 [917,]        NA        NA        NA
 [918,]        NA        NA      3.04
 [919,]        NA      2.24        NA
 [920,]      0.88        NA        NA
 [921,]        NA        NA        NA
 [922,]        NA      2.31        NA
 [923,]        NA        NA        NA
 [924,]      0.96        NA        NA
 [925,]        NA      1.97        NA
 [926,]      0.96        NA        NA
 [927,]        NA        NA        NA
 [928,]        NA        NA      3.23
 [929,]      1.08        NA        NA
 [930,]      1.07        NA        NA
 [931,]      1.06        NA        NA
 [932,]        NA      2.07        NA
 [933,]        NA        NA      3.15
 [934,]        NA      1.90        NA
 [935,]      0.74        NA        NA
 [936,]        NA        NA        NA
 [937,]      1.08        NA        NA
 [938,]      0.99        NA        NA
 [939,]      1.07        NA        NA
 [940,]        NA      1.64        NA
 [941,]        NA      2.02        NA
 [942,]      0.90        NA        NA
 [943,]      0.85        NA        NA
 [944,]      1.03        NA        NA
 [945,]      0.98        NA        NA
 [946,]      1.12        NA        NA
 [947,]      1.05        NA        NA
 [948,]        NA        NA        NA
 [949,]        NA        NA      3.25
 [950,]        NA        NA        NA
 [951,]        NA        NA      3.22
 [952,]        NA      2.06        NA
 [953,]      1.15        NA        NA
 [954,]        NA        NA        NA
 [955,]        NA      2.03        NA
 [956,]      1.04        NA        NA
 [957,]      0.69        NA        NA
 [958,]        NA      1.95        NA
 [959,]        NA        NA      3.28
 [960,]        NA        NA        NA
 [961,]        NA      2.17        NA
 [962,]        NA      1.94        NA
 [963,]        NA        NA        NA
 [964,]      0.94        NA        NA
 [965,]      1.01        NA        NA
 [966,]        NA      2.00        NA
 [967,]        NA        NA        NA
 [968,]        NA        NA        NA
 [969,]      0.75        NA        NA
 [970,]      1.11        NA        NA
 [971,]        NA      2.28        NA
 [972,]        NA        NA      3.15
 [973,]      0.76        NA        NA
 [974,]        NA      2.01        NA
 [975,]        NA        NA        NA
 [976,]      0.89        NA        NA
 [977,]        NA        NA      3.33
 [978,]        NA      1.89        NA
 [979,]      0.86        NA        NA
 [980,]        NA        NA      3.09
 [981,]        NA      2.17        NA
 [982,]      1.01        NA        NA
 [983,]        NA      2.10        NA
 [984,]        NA        NA      3.05
 [985,]        NA      2.01        NA
 [986,]        NA      2.08        NA
 [987,]        NA        NA      3.11
 [988,]      1.14        NA        NA
 [989,]        NA        NA      3.30
 [990,]        NA        NA      3.12
 [991,]        NA        NA      3.04
 [992,]        NA        NA        NA
 [993,]        NA      1.89        NA
 [994,]      1.09        NA        NA
 [995,]        NA      2.13        NA
 [996,]        NA        NA      3.19
 [997,]      0.83        NA        NA
 [998,]        NA      2.03        NA
 [999,]        NA        NA        NA
[1000,]        NA      2.11        NA
> 
> all.equal( rowSums( zGrad2, na.rm = TRUE )[ z != 0 ], 
+    model2$deriv.mat[ z != 0 , 3 ] )
[1] TRUE
> 
> proc.time()
   user  system elapsed 
  8.176   0.064   8.250 
