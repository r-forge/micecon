\documentclass[12pt,english]{article}
\input{micEcon_commands}
\makeatother

\begin{document}
\begin{center}
\textbf{\LARGE
Microeconomic Analysis with \proglang{R}
}
\vspace{3em}\\
\parbox[t]{0.49 \textwidth}{\centering
\textbf{Arne Henningsen}\\
Department of Agricultural Economics\\
University of Kiel\\
Olshausenstr. 40\\
D-24098 Kiel (Germany)\\
Telephone: +49-431-880 4445\\
E-mail: \url{ahenningsen@email.uni-kiel.de}\\
URL: \url{http://www.uni-kiel.de/agrarpol/ahenningsen/}
}
\parbox[t]{0.49 \textwidth}{\centering
\textbf{Ott Toomet}\\
Department of Economics\\
Tartu University\\
Narva 4-A123\\
Tartu 51009, Estonia\\
Telephone: +372 737 6348\\
E-mail: \url{otoomet@ut.ee}\\
URL: \url{http://www.obs.ee/~siim/}
}
\vspace{3em}\\
\end{center}

\section{Introduction}
Since its first public release in 1993, the free open source statistical
language and development environment °\proglang{R}° \citep{r-project}
has been increasingly used for statistical analysis.
While it has been prevalent in many scientific disciplines for a long time,
it was not very widespread in economics in the first years.
However, this situation has changed in recent years.
Consequently, the number of extension packages for \proglang{R}
that are suitable for economists
has strongly increased in the last few years.
One of these packages is called °\pkg{micEcon}° \citep{r-micecon} and provides
tools for microeconomic analysis.


\section{Microeconomic Modeling}

The \pkg{micEcon} package includes several tools for microeconomic modeling.
For instance, these models include
the °Almost Ideal Demand System° (AIDS) \citep{deaton80a},
the °Symmetric Normalized Quadratic° (SNQ) profit function
\citep{diewert87,diewert92,kohli93},
and stochastic frontier models \citep{coelli96}.


\subsection{Almost Ideal Demand System}

The °Almost Ideal Demand System° (AIDS) \citep{deaton80a}
is the most popular demand system in empirical demand analysis.
It is based on the following expenditure function:
\begin{equation}
\ln e( p , U )
= \alpha_0
+ \sum_{i=1}^n \alpha_i \ln p_i
+ \frac{1}{2} \sum_{i=1}^n \sum_{j=1}^n \gamma_{ij}^* \ln p_i \ln p_j
+ \beta_0 U \prod_{i=1}^n p_i^{\beta_i}
\end{equation}
where
$e( p , U )$ is the minimum expenditure to obtain
utility level $U$
given consumer prices $p$,
$n$ is the number of goods,
$p = (p_1 , \ldots , p_n )$ are consumer prices,
and all $\alpha$s, $\beta$s und $\gamma$s are parameters.
Based on this expenditure function,
following Marshallian demand functions can be derived:
\begin{align}
x_i ( p, m )
& = \frac{m}{p_i}
   \left( \alpha_i + \sum_{j=1}^n \gamma_{ij} \ln p_j
   + \beta_i \ln \left( \frac{m}{\mathcal{P}} \right) \right)
\label{eq:aidsDemand}\\
\text{with } \ln \mathcal{P}
& = \sum_{i=1}^n \alpha_i \ln p_i
+ \frac{1}{2} \sum_{i=1}^n \sum_{j=1}^n \gamma_{ij} \ln p_i \ln p_j
\label{eq:aidsTranslog}
\end{align}
where $x_i$ is the demand for the $i$th good,
$m = \sum_{i=1}^n p_i x_i$ is total expenditure,
and $\gamma_{ij} = ( \gamma_{ij}^* + \gamma_{ji}^* ) / 2$.
These demand functions can be simplified
by multiplying both sides by $p_i / m$.
Now, we have expenditure shares $s_i = p_i x_i / m$ on the left hand side:
\begin{equation}
s_i ( p, m ) = \alpha_i + \sum_{j=1}^n \gamma_{ij} \ln p_j
   + \beta_i \ln \left( \frac{m}{\mathcal{P}} \right)
   \label{eq:aidsShares}
\end{equation}
The °adding up° restriction,
i.e.\ the expenditure shares have to sum up to one,
requires
\begin{align}
& \sum_{i=1}^n \alpha_i = 1\\
& \sum_{i=1}^n \beta_i = 0\\
& \sum_{i=1}^n \gamma_{ij} = 0 \; \forall \, j
\end{align}
Homogeneity of degree zero in prices requires
\begin{equation}
\sum_{j=1}^n \gamma_{ij} = 0 \; \forall \, i
\end{equation}
And symmetry requires
\begin{equation}
\gamma_{ij} = \gamma_{ji} \; \forall \, i,j
\end{equation}

The demand functions~(\ref{eq:aidsShares}) are non-linear in parameters
due to the translog price index~(\ref{eq:aidsTranslog}).
However, if the translog price index~(\ref{eq:aidsTranslog})
is approximated by a price index
that does not depend on any estimated parameters,
the demand functions become linear in parameters.
Althoug this °Linear Approximation° (LA-AIDS) simplifies econometric estimation,
it introduces several other theoretical and econometric problems.

The package \pkg{micEcon} provides many functions for demand analysis
with the AIDS.
For instance, it can be used for:
\begin{itemize}
\item econometric estimation using
   the popular but inaccurate °Linear Approximation° (LA-AIDS)
   and the accurate °Iterated Linear Least Squares Estimator° (ILLE)
   \citep{blundell99}
\item searching for the intercept of the translog price index ($\alpha_0$)
   that gives the best fit to the model
\item optional imposition of homogeneity and symmetry
\item checking for monotonicity and concavity
\item calculating predicted quantities and expenditure shares
\item calculating Marshallian (uncompensated) price elasticities,
   Hicksian (compensated) price elasticities,
   income (expenditure) elasticities, and their standard errors
\end{itemize}


\subsection{Symmetric Normalized Quadratic Profit Function}

The °Symmetric Normalized Quadratic° (SNQ) profit function
\citep{diewert87,diewert92,kohli93}
is an advanced model for production analysis.
This functional form,
which is also traded under the name of
°symmetric generalized McFadden function° \citep{diewert92},
is often used in microeconomic production models
because it allows the imposition of global convexity.
The profit function is defined as follows:
\begin{equation}
\pi ( p, r )
= \sum_{i = 1}^n \alpha_i p_i
   + \frac{1}{2} w^{-1} \sum_{i = 1}^n \sum_{j = 1}^n \beta_{ij} p_i p_j
   + \sum_{i = 1}^n \sum_{j = 1}^m \delta_{ij} p_i r_j
   + \frac{1}{2} w \sum_{i = 1}^m \sum_{j = 1}^m \gamma_{ij} r_i r_j
   \label{eq:snqProfit}
\end{equation}
where
$\pi ( p, r )$ is the maximum profit that can be obtained given
netput prices $p = ( p_1 , \ldots , p_n )$
and quasi-fixed inputs $r = ( r_1 , \ldots , r_m )$,
$w = \sum_{i = 1}^n \theta_i p_i$
is a factor to normalize prices,
$\theta_i = \left. \overline{p_i \left| x_i \right|} \right/$
$\sum_{j = 1}^n \overline{ p_j \left| x_j \right| }$
are predetermined weights of the individual netput prices,
$x = ( x_1 , \ldots , x_n )$ represents the netput quantities,
$\overline{ p_i \left| x_i \right| }$ denotes the average absolute
value of netput $i$,
and all $\alpha$s, $\beta$s, $\delta$s, and $\gamma$s are the parameters.
To identify all parameters, the restrictions
$\gamma_{ij} = \gamma_{ji} \; \forall \, i,j$,
$\beta_{ij} = \beta_{ji} \; \forall \, i,j$, and
$\sum_{j = 1}^n \beta_{ij} \overline{p_j} = 0 \; \forall \, i$
are generally imposed,
where $\overline{p_j}$ are the mean prices \citep[p. 54]{diewert87}.

The corresponding netput equations can be obtained using Hotelling's Lemma:
\begin{equation}
x_i ( p , r )
= \alpha_i
   + w^{-1} \sum_{j = 1}^n \beta_{ij} p_j
   - \frac{1}{2} \theta_i w^{-2} \sum_{j = 1}^n \sum_{k = 1}^n
      \beta_{jk} p_j p_k
   + \sum_{j = 1}^m \delta_{ij} r_j
   + \frac{1}{2} \theta_i \sum_{j = 1}^m \sum_{k = 1}^m \gamma_{jk} r_j r_k
   \label{eq:snqNetput}
\end{equation}

The package \pkg{micEcon} provides many tools for production analysis
with the SNQ profit function
For instance, it can be used for:
\begin{itemize}
\item econometric estimation
\item imposition of global convexity using a recent two-step
   estimation procedure \citep{koebel03}
\item calculating price elasticities of inputs and outputs and their standard errors
\item calculating fixed factor elasticities
\item calculating shadow prices of fixed factors
\item calculating Hessian matrices and their derivatives with respect
   to coefficients
\item calculating predicted profits and netput quantities including
   standard errors and confidence limits of prediction
\end{itemize}


\subsection{Stochastic Frontier Models}

Stochastic frontier analysis is a popular tool for production analysis.
It can simultaneously model production technology
as well as possible technical (and allocative) inefficiencies.
\pkg{micEcon} provides a convenient interface to
Tim Coelli's software for stochastic frontier analysis
°FRONTIER 4.1° \citep{coelli96}.
It can be used to write input files for and read output files of °FRONTIER 4.1°.
Hence, the model or the data can be easily modified in \proglang{R}
and the estimation results can be conveniently used
for further analysis.


\subsection{Other Microeconomic Model}

Furthermore, \pkg{micEcon} includes tools for other functional forms,
namely translog and quadratic functions.
\pkg{micEon} provides functions for
\begin{itemize}
\item econometric estimation
\item calculating derivatives with respect to regressors
\item calculating (bordered) Hessian matrices with respect to regressors
\end{itemize}

\section{Sample Selection Models}

\input{selection_intro.tex}
\input{selection_implement.tex}
% \input{selection_usage.tex}

Furthermore, the \pkg{micEcon} package helps users to estimate
non-standard two-step selection models,
because it can calculate selectivity terms (°inverse Mill's ratios°)
from univariate and even bivariate probit models.


\section{Conclusion}
On the useR! conference,
we would like to present the capabilities of the \pkg{micEcon} package.
Applied economists interested in microeconomic modeling will be invited to
join our team and contribute to this package
by providing tools for other types of microeconomic analyses.


\bibliographystyle{jss}
%\bibliography{/home/suapm095/Documents/Literatur/literatur}
\bibliography{micEcon}

\end{document}
